{"componentChunkName":"component---src-templates-post-tsx","path":"/2018/01/03/scene-kit-physically-based-rendering/","result":{"data":{"markdownRemark":{"html":"<p><em>In this post I will guide you in the creation of a scene using SceneKit and its physically based rendering features.</em></p>\n<hr>\n<p>SceneKit is one of the framework inside the iOS SDK that I love the most. What is SceneKit? Let's see the definition\nfrom the developer apple website:</p>\n<blockquote>\n<p>SceneKit combines a high-performance rendering engine with a descriptive API for import, manipulation, and rendering of 3D assets. Unlike lower-level APIs such as Metal and OpenGL that require you to implement in precise detail the rendering algorithms that display a scene, SceneKit requires only descriptions of your sceneâ€™s contents and the actions or animations you want it to perform.</p>\n</blockquote>\n<p>As you can see from the definition there's a lot of stuff inside it. Basically by using SceneKit you will be able to\ncreate games and other 3D applications without the need to know any computer graphics algorithms, physics simulations\nstuff and so on. You basically describe a Scene in terms of objects and features and Apple will do everything for you :\nsunglasses:.<br>\nOne of the most interesting thing about SceneKit on the computer graphics side has been introduced in 2016: physically\nbased rendering (PBR).<br>\nWe've already seen what PBR is\nin <a href=\"/2017/12/07/physically-base-rendering-introduction/\" title=\"physically based rendering introduction post\">a previous post</a>\n, so you already know its theoretical foundation stuff (or go to check it out in case you missed it <img class=\"emoji-icon\" alt=\"emoji-wink\" data-icon=\"emoji-wink\" style=\"display: inline; margin: 0; position: relative; width: 25px\" src=\"data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAATzUlEQVR4Ae2bBXAbS7O2n57Z1UqyjHFsJzlMOczMjP93mOEy3/tdZmZmZmZm5nuYOcxkJzHbot2Z/r32VGXLZedgcrGr3uoV9/P2zEizkvhfHf8X/xf/F8IRjm8F8+STnBQp52A4S4RTBIaMlR6UKgBC3TudUBhWZTOedzLhrd/8TbYC/oga8K1HBlq2PcWlKtwdW241sZxpY1M1JYMpCWIE7CLvnaJe8e1cHpf6uk/13dTx96L8+Ym/wYuA/pceAS9/guqKHh42ls8olc1VtmKMqVpMkoMrYjxidU4CIlAMVdTlEtQbfFvwLY+vO1zD+3bTP+Mdvzw6we8D9Y/NgLmiP3JMTxOdcCxPRrF8RalizradEabDYMuKiT2SlDCVHmzXaugYQKpDSKmGmBIA6ttoewatD8PsftzUXnxjAm218anBNQU/63HTGe2GfztL9Ye27+I3gewjG/Av1/ORYvVqLi3HfHe5Zm+KuiOiLoskDlOOiHqOxQxdgBm8CKmdgpT7IKqCWBAKI1pAAXWQ1dHmGDqzGT/yCn74NbKJXfhmhrYs2ZQjm8xozrh/aqZ8PfDiRzJgw+N8qFj728jWJ/jyclW+rdQbd9iemKjqMdWIaPAc7PG3YlZeCpW+AJcBHjRAC6AscSyAAYlAgMYY/sCLuB1/TzbyFr6ekdUNbiKlPZ7ONuv6LSf9Fj8M6NFaA+Tlh+haWeEny532ybi/RNRtsRVHNHAa9pQHMAOXQ1QGbYM6RAwfJlR9GC0lyJr4/c/jNv8R2f6NuIYlm3SkB9s0p91vHmjwRRf/AVOAHkkD5NW7WdXXx29Vu6Pr48ESUacQ1ebyybdhTngASXrANxEAkQ/3aspiJ1AAU0ZbE/jtcyZs+TuymTbZtJKOtKlPZv86NsYTF/45+wD9+A0I8P19/Gl5RXxJsjLBdkLU20t0xmOYwWtAUwQPIh/ve4wWjTAgMX7kP8jW/Q7Z+DhuGloHWjRH05cOjnHvBzHBvl/4v72N3uMH+IM5+CuToQTbLcQr+onP+WxM//mIn0U0AxxotiBC/riEQzRDtInUjsd0H4/MbkBpYEoW8bqmhL/ktkH+7De30IT3juh9jhJz+hA/Xu6Nrk0GEmyXIe7tmev8U5iuEyAdBzHFxeyIjIDiZXENZO61ozOfgnW/BjJB4hPweu3pmv048KmAB/TDj4AAv/FJvrzWY7+iNJTMgUfEnQnRKfciPWvnOw++2PGjIxz4BiR9mHInMrMRjIIRTNuf+zmn6cxPvMnzH34NCPDPPsRFJ/TKP5fXlDtKKxOiLoiOvRqz5mYgAxEEQDi6oaAAqkCE3/OPZLueJpuCdr4e7GnObh/XG6/8A1453Eiwh4N/apDyvWfza9WVpVNz+LjLYvtWYVffCEZBM4QM1B3d7geJpuE4RcorobUbcbMggjgtlVO3dnQvv/fmLO6DTgED2N+/l8e7euwXlwYTop4E22GxQ5ch1QHwLYTiohckDiIPkQIpZOmRN8GnYCwyJ+o7AAOqSNMff8kq3fKTb/EWoEHvaYAA9usupfuq1fLL5cFSf7wiIapZbPdKzIrzAIeQFjofwBNwjQY7tg+zbdNecG06a/bIjwQWTJCoAq1hyOqoCuoUZt3p5ZjfenoP7aUMiJbr/mOn8EDSZddGXRGmMqfEILU1IIr4OogAIZKIdiPlH/96PX//T+vYvWeUkQMpa88c4qd+4AGSGPDKkQxRRSWar9HUR+drzmtPurK1j52SPfA9L/JrgALucAYIIJf1kXSW5TPzjY3piLBlgyQJUu5GfAPwEPipxGzfNMLP/OKzbN64j7KFioGb7riE+x6/haQ0Ce1g2JEMBSGFvMYkwaYtfMfC5qxzyn3mZX36uy+M4QKjHs4A+73XcmGlKhfbWoQpW0zJIKUKYiJwDRAFgHLEmy/t4kd/+hlco85QDXpXD3LXpz/IFVeeAlPbYWIMEI5KqOQ1ztdqSul87TlDpZpe/L3X6oU3/CnPAf5wBhjADtbM3XHNGlO12JJFIgNREuZ7Cgoklk3rRviRn3qG2LXpSOD0S8/mkS+8h/7qLOz4D/AOxHJ0QyBK8prna3dVS84yWONu8C8CDvBLGSCAOamXuFLWG2T+TI5FYoNEgrER+BbgwQrTYxk/80uvYNIWlRguu+tyHvrUK4knN8LuSTAWEND0o+2GjIAtPNYrOGX5MPO1+kjy2hcYqpZKObshZ9s6TgYIoEsa8C0XcVJSlrW2YpGSxeQGWAu4BQPUQ8ny53+9meE9E/RWhKvvu4QHHz8XGX4HWikYA94fglEFfMiFy2jxpUEECCpZMIbGVMrYRJt25omsobszoqu7BLGBzEOmoEUKAzjE5rXrPEPOkjN9y0V60qf+I+sOZ4A9tpNzosRUTGIwkUA4f4e2wNfBGsaH2zz9wj4SA5fdcRYPPnIysnsdpBmIh9SFqeIICuBFaF3mQ6nMw23bmPEn/zTDxq0NZmbbZJkSWaFajRhYWeH8M3u48qI+Vh9TIRgR6tSFWmWh9pwhZ8mZju305wAbAVl2CvRUzJk2ESQWxBrESK4FoGwa4irvbp5kz+4GV924mkefOA7ZtQ7aDcAXYBWsgBHIAizy3tMhUnbubvLF37GH+rRnoBsqJaFiBFHwMxk7J5ts2DDGn/3dbq6/op9HPzFER2cErQCvaag7MMRCzpSzgf+T5QwwuZJIT5bIIDaXgAlDEyCbhSxjptlg4JROPu2zVlE6uBkaKRgpgAkkMgfgmJ51DK6MAQXHe4eHck+Zuz/1eLo6DL3dEQZoNhxToy0O7msyOqexkRaTUyl/8pd7eHP9JF//uasZ7LeQtQFAFmoXG0yIDEmUnUzgXGyABNlYGCAMfZEAjwEFAOpNrrqig4tvW8mK5izMZGAMFCMRXnq9wU//zihjkxlXX9jBFz2xgkpiwCmHDQcDXcJnP9wLRsB5UMAaMGY+z7Rg33DKu29O8eozozz/3ATf//O7+P6vWo0F0IAjfoHBCkTCPBvYAq8ungKxjeiRMO+xhdVCFREBhZprU5tMoekgXEfB0pHhlJ/6zQO4lmd1l/D0i9P0dVk+89G+YIAcfg/azGDrOMCiBU5AoFaynFqLOfX2Lu68cwVvbmiwd1sdr4pBQQEEIOAKOVPOBsSHXQOMUBYTwHVBogoCqgoALQcAEm4rTunI8B8vz6Jtz8mDlthCR0l4+c1Z7ru5k74eC85z2IgFolAEgAZ5hUyhlUEjhf114thw0UCZi1aX0ZEG+GBwMCKUjhjI2QCzlAESshEBJbgYHFD1EBZZ4NCzLrW2Odi2u01/TeguC1EYRdNjnh3DKX39svw0EKAk7B9OeW19i137MtqpUk6EoRWW41bFnLAmptZtoQU6b4hDR2aAQAmwqH4ARQn1m6WmgIZsnKeJI0A7VAVRC0DwNvAryFJnwJRWy1GOhSiCyEASg1VopBlEFlJdtvN/+c91fufPp2g2PYkVjAFC4z3Q3WW5/tIqD97SQSkCdYAQ6nQogBLqdAvyHhzMs4Eh2LPkXiDzTKn3qMvmJKDBDIHwSgSHg48KUvA1MtS6hOYYCCEUSiWh2umAFpglDEiE199M+dU/mGZlTTixzxJbQQDvIXOQqTJR9/zWnEFZlvGpD1TRRvGThaCEGgkPdGlg8eRsh9sOK0Ar46B6D96halBvEDwoAKjoIRMo2B0kJeGEk4XdGw/dLc2g0mE45ngPmoFduvt7xjNoQ4cVTCqoA2IoVYQS0JiBiizcXseDSUEUUVBCASpA6JHXObnA4ufZltsNahCTbdmxOlXUKfhQsBfUgABhVUTDQ6S4pIhCGy6/0vDC08LktFKtCqPjygW3WvoHUpjyS5+FSOHamyxjvsTsqLLqGMOq4w39qwwdHYIITE7AlvWOFLjufItOtQOvAEUDCOYvMGimaKrzbKAsNwUUyHZM+S1r2xbvFO89Rg1CYZgXP8NbRQUwioSsDob6PQ98ruUvftWxf1I59WrDPY8oNNKl4QE8dFrHU59qw15CoZlBQ6EtoDDQA6febMALDLfwCmIEnIAASHgsAHglZ1hgaUPOBrjltsMeyJ7Zx9abTvVNUl9WZ1DvAQmdVhAPYRRgNGQOZRQm4eIzDaf+gDBdV9b0eWTcgwcMS4eE0vZksHivpGEtmgXGBfXhOhtyEBSMcKA+jOTM41q+mbMBKeAJYRYZkP76O+yeabDFtxTNwhAiDHeriChiFoSEy3iEULUoWA+jGd2zGcfEDjmQQduD9WDeQzbkOJdCpGB9kIL4hdeX4BAKskiqKKH2VMlZcqac7XAGKNCaTUlHpuR5zQ1IAR9U2LUSJLK0EAEDtBXqCoRNkbC8TFECsuj+COEwcBZvWkLFM/UNJWfK2YAWoMsZkAKNf9zln87q6rWpuDbgFDTUZJYWRiFkgrDFaZKLIF1GLMjq4e8jurSBwTNVwCkug5wha6rPmYAGkC5nAIAH6j/8EuvHJvVtV/do2+NTBU94MQkCjBA6FrTEdWUgXlysLC3hkBKgvMxz2yWuk7BtD933maItj2t4cpacCagHRg5nQGMqpfH6Xv1TnfHzDhKmgnrCCxH220XgcGwP5czDG28I09NADUgIty8hCTkBOmDPHli/PjyfwOLnxoYaQhYBEPCF72paik57cpacCebl3+uLEQ8kr+1n8pFTuK5clR5JBFMCiUx4QUAKMJZwOZgRjt2cvvY7hD/9C0MswsAgVHpCZ6OgOECXAGDXTuH3f9/wXT9oaHu4+jogEyAAioRcEAtSFTQVtOFxM55szDMx7LZ/2l/z4+MtRoCx9/peACADprdMMv3cLv3123v8N9sOg6+ASYBYwLK4c0EKQihQibvg4UeFn/4+4dd/Rfirv1ROOx1OO00ZHFI6a+A9TEzB3t3C+nXC1k0wMSF0V+G+hwAFDAEU8OHYCPgFCYeONQXfBDejuAlPzpCzwLwygPcyQIEZYOLz/4l/e36Vf3VVp7tQqoKpgIkNWEFscRQUVGgWDbjjbti8DtY9LVS8sP4VeP0FRcJjRcF7EBU6EuhNIOqAuz9LWXsWMCpgABUgwEvxfT+A58ogzHuyScfIQf9qzgBMBCZ9v1+OOsC0MiqxYedlA3qbLZmIkmAiECuQ50jAUtCihU5kPp11eX6SE5oHhYE+YUVN6KkK3ZWF3N8prOwSOstCqy5cda/wwKcoMlkANoQcLhOkgjrQVPB1Tzqt80O/MZI1f+wF/dZ/28lOYASY/qA/kHBA9Pxe/DVDpnVcTS81sZBLIiCYIEbAFOANgBTej4WkDGdfaxjeBwe3QSWCjjJUS1CJIbaQtaDt4KqH4f5PU8y0QvEjLmYReAG+BdpQ/LTixj3Zfsezm/i5L/1nfRoYBg4C2Qc1wAdFv7te9z54IoM9iZ5MLAvQUTBCggmhxhChWMAIpJCU4LwbhPKAMDoiTI9DK4dOwVkYOkP4f58nXH0LyIRCVgTNBSBQnO8ZaBt8HfyUko572iMZW3b4v7/p9/RXgJGg+of9lZgFBoA1p/dx/J8+IN84eJw9Px6yxH0G22swVYFEkRiIih/RFCjsDxSIgB6h7YTh3cLYfrARrFwNQ0MKqcKkggcozHsvATxc52QenLbg6wuLXTo2pxHHyE73+r1/pN+5fowdwB5gP+A+7G+ENDyYgw3s6wd4++YhPbNiWEkkh96RMKFbIMgS/hZAZhWbQnc3DK2BwUGlFgFTCg0OdR0TOh+yz2XQVKAtaDOH96HzC/D797h1n/U3+j2vjrAH2AeMAe2P+jO5DPAAO6eQ10d47fp+PanD6KrwVoRosXCQ4AxKgGDxEA77hOKHU1kQIRfhnQldZ94ArYPOeLJJJcvh92Xs3elf++y/1u99ejd7CvN+9uP6nWCbgDFngv7DFl65cZCeLtGTw+YL8QoKooJqwRiRAnwAZRlpkDfgglE5cK62QBP8rKJTC/Bu1JMOOzZv9//w0J/pj881Z28BfhLg4zIAoAV4QMdayM+/wRuX9svkoHXnmIxoAToABjOAYMqi922Kx0t0PptX+P1TYZWfAZfDjyvpfkd9OGv+xwZ+4Zbf1d8aa3AQGAEOABMAH7cBwQRcMML8/jrdnbZ4+bSKDla9rtJwizpCBwn3FtQVOwwohbkNZIAL4O1coE1F6yyAT3vcpCcd9WQjjr27/Ks/+qz+wFf8s74IjAb40Hn0iP5aHOgEVgT1ViydP3U7V15/otzf029OtN0G27nwDiEVwZaAkiAxYDm0iRIAQAGvaDBMU6CluHbofF1xMwsGTBz02/51m/7xF/4tzzYc08A4MBo0DejR+stMDegGeoEeoGtNjdp3Xs/FVxwrt63olXOimpHcBFs1SCJICSTsJXIZAwA+gKNhB9deyK7u5+GzGa+jY/rWc7v1777xX3l5zwwzwBQwEQyYBGb+M/4zlITR0BVM6AzGRF96MSfedaq5+MRevbjWyQmliklMIhA+SZqoOALC/j0DwimsdsO3ZqbZvm1cXv6rTf7lH32ZbUAWQKcD/FQ4bv1n/mnKAJUAH0QV6AASC+YTpzFw7bGsWbvCHNtf1dXVmL4kohZbEoDU0WplzNRTxg7WZe+GUb/r33ex5y82st+BD4CzQD0AB9EA/H+Vf41FwYiOoGq4XAZKQTbIF3IwEUfIQe2gJtAI8LNBDSD7r/rHyYhwQiuoEuCLJpiQi+EAX4QPagDNoBaQ/Xf556gA8SJFIRf3jwBaMCAFspCL0iNV5NGKAI0JkiX2HT4omHHk4/8D9hvljachrR4AAAAASUVORK5CYII=\" title=\"emoji-wink\">). So that\nmeans that SceneKit could render physically based scene using its own entirely new physically based rendering engine. Is\nit worth it? Sure!! <img class=\"emoji-icon\" alt=\"emoji-blush\" data-icon=\"emoji-blush\" style=\"display: inline; margin: 0; position: relative; width: 25px\" src=\"data:image/png;base64, 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\" title=\"emoji-blush\">  So, let's try it!\nIn this post we will create a scene from scratch that uses the main PBR features you can find inside SceneKit. At the\nend of this post you will be able to render the scene contained in the image below. So it's time to start coding!!</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1140px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/12d0892d46967ae2bc6f295a37ba7f0f/c58a3/physically-based-rendering-scene-right.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.614035087719294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAgX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAFGOmgsKg//xAAaEAABBQEAAAAAAAAAAAAAAAADAAEEETMC/9oACAEBAAEFAid0ZitcB7jl0QMv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGxAAAQQDAAAAAAAAAAAAAAAAAAECAxARUoH/2gAIAQEABj8ClztXR1If/8QAGhAAAgMBAQAAAAAAAAAAAAAAAREAITEQof/aAAgBAQABPyFKc2VzaDeXCNJJvs93R//aAAwDAQACAAMAAAAQQA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAdEAEAAgEFAQAAAAAAAAAAAAABACERMUFRobFx/9oACAEBAAE/EBcYbjo4hFkGguoOpiKzWZ1Xk3Ps7L6z/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"A physically based scene created using SceneKit\"\n        title=\"A physically based scene created using SceneKit\"\n        src=\"/static/12d0892d46967ae2bc6f295a37ba7f0f/0470c/physically-based-rendering-scene-right.jpg\"\n        srcset=\"/static/12d0892d46967ae2bc6f295a37ba7f0f/6c669/physically-based-rendering-scene-right.jpg 285w,\n/static/12d0892d46967ae2bc6f295a37ba7f0f/882a4/physically-based-rendering-scene-right.jpg 570w,\n/static/12d0892d46967ae2bc6f295a37ba7f0f/0470c/physically-based-rendering-scene-right.jpg 1140w,\n/static/12d0892d46967ae2bc6f295a37ba7f0f/c58a3/physically-based-rendering-scene-right.jpg 1500w\"\n        sizes=\"(max-width: 1140px) 100vw, 1140px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">A physically based scene created using SceneKit</figcaption>\n  </figure></p>\n<p>The general approach used in the construction of the scene will be the following: for each main scene category component\nwe will create a class that encapsulate the creation of the corresponding <code class=\"language-text\">SCNNode</code>, the base SceneKit unit element, and\nits setup to obtain the feature we want.<br>\nThe first class we are going to create is the <code class=\"language-text\">Light</code> class that encapsulate the base features we need to set up the\nlight: position, rotation and generic color. Light in SceneKit are represented using the <code class=\"language-text\">SCNLight</code> class.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Light</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> node<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNNode</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>lightNode<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNNode</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node <span class=\"token operator\">=</span> lightNode\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>lightFeatures<span class=\"token punctuation\">:</span> <span class=\"token builtin\">LightFeatures</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node <span class=\"token operator\">=</span> <span class=\"token function\">SCNNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">createLight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span>lightFeatures<span class=\"token punctuation\">:</span> lightFeatures<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">createLight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span>light <span class=\"token operator\">=</span> <span class=\"token function\">SCNLight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span>lightFeatures<span class=\"token punctuation\">:</span> <span class=\"token builtin\">LightFeatures</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span>light<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> lightFeatures<span class=\"token punctuation\">.</span>color\n        node<span class=\"token punctuation\">.</span>position <span class=\"token operator\">=</span> lightFeatures<span class=\"token punctuation\">.</span>position\n        node<span class=\"token punctuation\">.</span>eulerAngles <span class=\"token operator\">=</span> lightFeatures<span class=\"token punctuation\">.</span>orientation<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The basic features of the light must be passed at construction time using a <code class=\"language-text\">LightFeatures</code> objects.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">LightFeatures</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> position<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector3</span>\n    <span class=\"token keyword\">let</span> orientation<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector3</span>\n    <span class=\"token keyword\">let</span> color<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIColor</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector3</span><span class=\"token punctuation\">,</span> orientation<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector3</span><span class=\"token punctuation\">,</span> color<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIColor</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>position <span class=\"token operator\">=</span> position\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>orientation <span class=\"token operator\">=</span> orientation\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> color\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We are now ready to create our <code class=\"language-text\">PhysicallyBasedLight</code> as an child of <code class=\"language-text\">Light</code> class. Our physically based light will be\nof type <code class=\"language-text\">.directional</code>, and we will customize its <code class=\"language-text\">intensity</code> and <code class=\"language-text\">temperature</code>. The intensity is the flux of the\nlight (again, go to\ncheck <a href=\"/2017/12/07/physically-base-rendering-introduction/\" title=\"physically based introduction post\">my first post about physically based rendering</a>\nif you don't know what it is <img class=\"emoji-icon\" alt=\"emoji-stuck_out_tongue\" data-icon=\"emoji-stuck_out_tongue\" style=\"display: inline; margin: 0; position: relative; width: 25px\" src=\"data:image/png;base64, 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\" title=\"emoji-stuck_out_tongue\">), and the second one is the color temperature expressed in Kelvin (\nremember: 6500 K corresponds to pure white sunlight). We activate other interesting features: by setting <code class=\"language-text\">castsShadow</code>\nto <code class=\"language-text\">true</code> we activate the rendering of shadow using shadow mapping technique, and by setting <code class=\"language-text\">orthographicScale</code> to <code class=\"language-text\">10</code>\nwe extend a little bit the visible area of the scene from the light, so we are improving the construction of the shadow\nmap.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">PhysicallyBasedLight</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Light</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>lightFeatures<span class=\"token punctuation\">:</span> <span class=\"token builtin\">LightFeatures</span><span class=\"token punctuation\">,</span> physicallyBasedLightFeatures<span class=\"token punctuation\">:</span> <span class=\"token builtin\">PhysicallyBasedLightFeatures</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>lightFeatures<span class=\"token punctuation\">:</span> lightFeatures<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span>physicallyBasedLightFeatures<span class=\"token punctuation\">:</span> physicallyBasedLightFeatures<span class=\"token punctuation\">)</span>\n        <span class=\"token function\">activateShadow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span>physicallyBasedLightFeatures<span class=\"token punctuation\">:</span> <span class=\"token builtin\">PhysicallyBasedLightFeatures</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span>light<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>type <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>directional\n        node<span class=\"token punctuation\">.</span>light<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>intensity <span class=\"token operator\">=</span> physicallyBasedLightFeatures<span class=\"token punctuation\">.</span>lumen\n        node<span class=\"token punctuation\">.</span>light<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>temperature <span class=\"token operator\">=</span> physicallyBasedLightFeatures<span class=\"token punctuation\">.</span>temperature\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">activateShadow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span>light<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>castsShadow <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n        node<span class=\"token punctuation\">.</span>light<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>orthographicScale <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>As for the basic light, we create also for the physically based features a class that will store the configuration and\nthat must be injected at construction time (as you can see from the previous class init), that we will\ncall <code class=\"language-text\">PhysicallyBasedLightFeatures</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">PhysicallyBasedLightFeatures</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> lumen<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGFloat</span>\n    <span class=\"token keyword\">let</span> temperature<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGFloat</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>lumen<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGFloat</span><span class=\"token punctuation\">,</span> temperature<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGFloat</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>lumen <span class=\"token operator\">=</span> lumen\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>temperature <span class=\"token operator\">=</span> temperature\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>For physically based rendering we need also another kind of lighting setup to achieve the best result. We need to set up\nthe <code class=\"language-text\">SCNScene</code>, the object that contains all the <code class=\"language-text\">SCNNode</code> elements of a scene, the <code class=\"language-text\">lightingEnviroment</code>\nand <code class=\"language-text\">background</code> properties. These ones let SceneKit approximate more accurately the indirect lighting calculation. To\nset this features we create a new class, <code class=\"language-text\">PhysicallyBasedLightingEnviroment</code>, that will receive the scene to setup. On\nthis class will set a cubemap on the <code class=\"language-text\">lightingEnviroment.contents</code> property and its intensity on\nthe <code class=\"language-text\">lightingEnviroment.intensity</code> property. To match the result of this lighting setup, it will set\nthe <code class=\"language-text\">background.contents</code> with the same cubemap used for the <code class=\"language-text\">lightingEnviroment.contents</code> property.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">PhysicallyBasedLightingEnviroment</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> cubeMap<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">String</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">let</span> intensity<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGFloat</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>cubeMap<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">String</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> intensity<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGFloat</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>cubeMap <span class=\"token operator\">=</span> cubeMap\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>intensity <span class=\"token operator\">=</span> intensity\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">setLightingEnviromentFor</span><span class=\"token punctuation\">(</span>scene<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNScene</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        scene<span class=\"token punctuation\">.</span>lightingEnvironment<span class=\"token punctuation\">.</span>contents <span class=\"token operator\">=</span> cubeMap\n        scene<span class=\"token punctuation\">.</span>lightingEnvironment<span class=\"token punctuation\">.</span>intensity <span class=\"token operator\">=</span> intensity\n        scene<span class=\"token punctuation\">.</span>background<span class=\"token punctuation\">.</span>contents <span class=\"token operator\">=</span> cubeMap\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Next step: the camera. We create a <code class=\"language-text\">Camera</code> class, that will contain a reference, again, to a <code class=\"language-text\">SCNNode</code> on which\nan <code class=\"language-text\">SCNCamera</code> has been defined. For the camera we need to set first of all some geometric properties like the position,\nrotation and the pivot point that we will use as reference for the animation of the camera. Last but not least we set\nthe flag <code class=\"language-text\">wantHDR</code> to apply <a href=\"https://en.wikipedia.org/wiki/High_dynamic_range\" title=\"High Dynamic Range\">High Dynamic Range</a>\npost processing to adjust the general brightness of the scene with respect to the display.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Camera</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> node<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNNode</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>cameraNode<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNNode</span><span class=\"token punctuation\">,</span> wantsHDR<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Bool</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node <span class=\"token operator\">=</span> cameraNode\n        <span class=\"token function\">setAdvancedFeatures</span><span class=\"token punctuation\">(</span>wantsHDR<span class=\"token punctuation\">:</span> wantsHDR<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector3</span><span class=\"token punctuation\">,</span> rotation<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector4</span><span class=\"token punctuation\">,</span> wantsHDR<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Bool</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> pivot<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNMatrix4</span><span class=\"token operator\">?</span> <span class=\"token operator\">=</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node <span class=\"token operator\">=</span> <span class=\"token function\">SCNNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">createCameraOnNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">setAdvancedFeatures</span><span class=\"token punctuation\">(</span>wantsHDR<span class=\"token punctuation\">:</span> wantsHDR<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">,</span> rotation<span class=\"token punctuation\">:</span> rotation<span class=\"token punctuation\">,</span> pivot<span class=\"token punctuation\">:</span> pivot<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">createCameraOnNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span>camera <span class=\"token operator\">=</span> <span class=\"token function\">SCNCamera</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">setAdvancedFeatures</span><span class=\"token punctuation\">(</span>wantsHDR<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Bool</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span>camera<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>automaticallyAdjustsZRange <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n        node<span class=\"token punctuation\">.</span>camera<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>wantsHDR <span class=\"token operator\">=</span> wantsHDR\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span>position aPosition<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector3</span><span class=\"token punctuation\">,</span> rotation aRotation<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector4</span><span class=\"token punctuation\">,</span> pivot aPivot<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNMatrix4</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span>position <span class=\"token operator\">=</span> aPosition\n        node<span class=\"token punctuation\">.</span>rotation <span class=\"token operator\">=</span> aRotation\n        node<span class=\"token punctuation\">.</span>pivot <span class=\"token operator\">=</span> aPivot <span class=\"token operator\">?</span><span class=\"token operator\">?</span> node<span class=\"token punctuation\">.</span>pivot\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now it's time to think about the objects we want to display in the scene. For that reason we create a <code class=\"language-text\">Object</code> class\nthat will represent each kind of object we want to show in the scene. Obviously as for the previous classes, also\nthe <code class=\"language-text\">Object</code> class will expose a <code class=\"language-text\">node</code> property of type <code class=\"language-text\">SCNNode</code> that represents our object in the scene. We define\nthis class with multiple initializer that let as create object instances using various configurations: init as an empty\nobject, init using a <code class=\"language-text\">SCNGeometry</code> instance, using a mesh loaded as a <code class=\"language-text\">MDLObject</code> using\nthe <a href=\"https://developer.apple.com/documentation/modelio\" title=\"Model I\\O\">Model I\\O</a> Apple framework. This framework let us\nimport/export 3D models in a wide range of common available formats.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Object</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> node<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNNode</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector3</span><span class=\"token punctuation\">,</span> rotation<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node <span class=\"token operator\">=</span> <span class=\"token function\">SCNNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        node<span class=\"token punctuation\">.</span>castsShadow <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n        <span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">,</span> rotation<span class=\"token punctuation\">:</span> rotation<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>geometry<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNGeometry</span><span class=\"token punctuation\">,</span> position<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector3</span><span class=\"token punctuation\">,</span> rotation<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node <span class=\"token operator\">=</span> <span class=\"token function\">SCNNode</span><span class=\"token punctuation\">(</span>geometry<span class=\"token punctuation\">:</span> geometry<span class=\"token punctuation\">)</span>\n        node<span class=\"token punctuation\">.</span>castsShadow <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n        <span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">,</span> rotation<span class=\"token punctuation\">:</span> rotation<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>mesh<span class=\"token punctuation\">:</span> <span class=\"token builtin\">MDLObject</span><span class=\"token punctuation\">,</span> position<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector3</span><span class=\"token punctuation\">,</span> rotation<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node <span class=\"token operator\">=</span> <span class=\"token function\">SCNNode</span><span class=\"token punctuation\">(</span>mdlObject<span class=\"token punctuation\">:</span> mesh<span class=\"token punctuation\">)</span>\n        node<span class=\"token punctuation\">.</span>castsShadow <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n        <span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">,</span> rotation<span class=\"token punctuation\">:</span> rotation<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector3</span><span class=\"token punctuation\">,</span> rotation<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span>position <span class=\"token operator\">=</span> position\n        node<span class=\"token punctuation\">.</span>rotation <span class=\"token operator\">=</span> rotation\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now we are ready to define a <code class=\"language-text\">PhysicallyBasedObject</code> class that will inherit all the capabilities of the <code class=\"language-text\">Object</code> class\nand will set all the features needed to make the object rendered using physically based rendering. Even if all the\ninitializer are available to this subclass, we will require a mesh as <code class=\"language-text\">MDLObject</code> at construction time, because we will\ndisplay some particular mesh objects (we will discuss about them later). At construction time we will require also the\nposition and rotation and the <code class=\"language-text\">PhysicallyBasedMaterial</code> material. By assigning it to the <code class=\"language-text\">firstMaterial</code> property of\nthe <code class=\"language-text\">geometry</code> of our node, our object will be rendered as a physically based object using the SceneKit physically based\nrendering engine. NB: the mesh that we will use doesn't contain any material so by assigning the <code class=\"language-text\">firstMaterial</code>\nproperty the mesh will use it for the entire surface.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">PhysicallyBasedObject</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Object</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>mesh<span class=\"token punctuation\">:</span> <span class=\"token builtin\">MDLObject</span><span class=\"token punctuation\">,</span> material<span class=\"token punctuation\">:</span> <span class=\"token builtin\">PhysicallyBasedMaterial</span><span class=\"token punctuation\">,</span> position<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector3</span><span class=\"token punctuation\">,</span> rotation<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNVector4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>mesh<span class=\"token punctuation\">:</span> mesh<span class=\"token punctuation\">,</span> position<span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">,</span> rotation<span class=\"token punctuation\">:</span> rotation<span class=\"token punctuation\">)</span>\n        node<span class=\"token punctuation\">.</span>geometry<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>firstMaterial <span class=\"token operator\">=</span> material<span class=\"token punctuation\">.</span>material\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>So, the next question is: how do we define the <code class=\"language-text\">PhysicallyBasedMaterial</code> class? We create <code class=\"language-text\">PhysicallyBasedMaterial</code> with\na single property <code class=\"language-text\">material</code> of type <code class=\"language-text\">SCNMaterial</code>. On this material property we set:</p>\n<ul>\n<li>the <code class=\"language-text\">lightingModel</code> to <code class=\"language-text\">.physicallyBased</code>, to mark it for SceneKit as a physically based material</li>\n<li><code class=\"language-text\">diffuse.contents</code> property with an appropriate diffuse value.</li>\n<li><code class=\"language-text\">roughness.contents</code> property with an appropriate roughness value.</li>\n<li><code class=\"language-text\">metalness.contents</code> property with an appropriate metalness value.</li>\n<li><code class=\"language-text\">normal.contents</code> property with an appropriate normal value.</li>\n<li><code class=\"language-text\">ambientOcclusion.contents</code> property with an appropriate ambient occlusion value</li>\n</ul>\n<p>As you can see, we have all the properties we discussed in\nmy <a href=\"/2017/12/07/physically-base-rendering-introduction/\" title=\"physically \nbased introduction post\">introduction to physically based rendering post</a>\n. We have also other properties that help us improve the realism, especially with indirect lighting for what concern\nthe <a href=\"https://en.wikipedia.org/wiki/Ambient_occlusion\" title=\"ambient occlusion\">ambient occlusion</a> (this property/technique is\nnot related to PBR but helps to improve the final rendering). Which kind of values accept this properties? As stated in\nthe Apple documentation you can assign to the <code class=\"language-text\">contents</code> property:</p>\n<ul>\n<li>a color (<code class=\"language-text\">NSColor</code>/<code class=\"language-text\">UIColor</code>/<code class=\"language-text\">CGColor</code>)</li>\n<li>a number (<code class=\"language-text\">NSNumber</code>)</li>\n<li>an image (<code class=\"language-text\">NSImage</code>/<code class=\"language-text\">UIImage</code>/<code class=\"language-text\">CGImage</code>)</li>\n<li>a string</li>\n<li>a <code class=\"language-text\">CALayer</code></li>\n<li>a texture (<code class=\"language-text\">SKTexture</code>/<code class=\"language-text\">MDLTexture</code>/<code class=\"language-text\">MTLTexture</code>/<code class=\"language-text\">GLKTextureInfo</code>)</li>\n<li>a <code class=\"language-text\">SKScene</code></li>\n<li>an array of six image that represents a cube map (as we did for the <code class=\"language-text\">lightingEnviroment.contents property</code>).</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">PhysicallyBasedMaterial</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> material<span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNMaterial</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>diffuse<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Any</span><span class=\"token punctuation\">,</span> roughness<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Any</span><span class=\"token punctuation\">,</span> metalness<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Any</span><span class=\"token punctuation\">,</span> normal<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Any</span><span class=\"token punctuation\">,</span> ambientOcclusion<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Any</span><span class=\"token operator\">?</span> <span class=\"token operator\">=</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        material <span class=\"token operator\">=</span> <span class=\"token function\">SCNMaterial</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        material<span class=\"token punctuation\">.</span>lightingModel <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>physicallyBased\n        material<span class=\"token punctuation\">.</span>diffuse<span class=\"token punctuation\">.</span>contents <span class=\"token operator\">=</span> diffuse\n        material<span class=\"token punctuation\">.</span>roughness<span class=\"token punctuation\">.</span>contents <span class=\"token operator\">=</span> roughness\n        material<span class=\"token punctuation\">.</span>metalness<span class=\"token punctuation\">.</span>contents <span class=\"token operator\">=</span> metalness\n        material<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">.</span>contents <span class=\"token operator\">=</span> normal\n        material<span class=\"token punctuation\">.</span>ambientOcclusion<span class=\"token punctuation\">.</span>contents <span class=\"token operator\">=</span> ambientOcclusion\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now it's time to construct our scene <img class=\"emoji-icon\" alt=\"emoji-relieved\" data-icon=\"emoji-relieved\" style=\"display: inline; margin: 0; position: relative; width: 25px\" src=\"data:image/png;base64, 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\" title=\"emoji-relieved\">!! We start by creating a new class <code class=\"language-text\">PhysicallyBasedScene</code>, subclass\nof <code class=\"language-text\">SCNScene</code>. In this way we can customize the default initializer with the step needed to add all the element of our\nscene, and also because in this way we have direct access to all the properties of <code class=\"language-text\">SCNScene</code>. We define a\nprotocol, <code class=\"language-text\">Scene</code>, that we will use to manage some gesture and animate the scene. So in the initializer we will call\nthree methods: <code class=\"language-text\">createCamera()</code> in which we will create the camera, <code class=\"language-text\">createLight()</code> in which we will create the\nlights, <code class=\"language-text\">createObjects()</code> in which we will create the objects. NB: we need to define also the initializer with coder\nbecause we are subclassing a class that adopt the <code class=\"language-text\">NSSecureCoding</code> that is an extension of the <code class=\"language-text\">NSCoding</code> protocol that\nhas this required initializer.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token atrule\">@objc</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PhysicallyBasedScene</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">SCNScene</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">Scene</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> camera<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Camera</span><span class=\"token operator\">!</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">createCamera</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">createLight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">createObjects</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">required</span> <span class=\"token keyword\">init</span><span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>coder aDecoder<span class=\"token punctuation\">:</span> <span class=\"token builtin\">NSCoder</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">fatalError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"init(coder:) has not been implemented\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>So we start by creating our camera. We place it in front of the scene with the pivot moved a little bit and HDR post\nprocessing activated.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">createCamera</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    camera <span class=\"token operator\">=</span> <span class=\"token function\">Camera</span><span class=\"token punctuation\">(</span>\n        position<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector3Make</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        rotation<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector4Make</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">GLKMathDegreesToRadians</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        wantsHDR<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        pivot<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNMatrix4MakeTranslation</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n    rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">addChildNode</span><span class=\"token punctuation\">(</span>camera<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then we create our lights. We create a physically based light with power of 100 lumen and a color temperature of 4000K.\nIn this way we can match the warm orange color of the cubemap used for the lighting environment that we set in the\nscene.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">createLight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">addChildNode</span><span class=\"token punctuation\">(</span><span class=\"token function\">createPhysicallyBasedLight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">)</span>\n    <span class=\"token function\">createPhysicallyLightingEnviroment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">createPhysicallyBasedLight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">PhysicallyBasedLight</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> lightFeatures <span class=\"token operator\">=</span> <span class=\"token function\">LightFeatures</span><span class=\"token punctuation\">(</span>\n        position<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector3Make</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        orientation<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector3Make</span><span class=\"token punctuation\">(</span><span class=\"token function\">GLKMathDegreesToRadians</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">45</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">GLKMathDegreesToRadians</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        color<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIColor</span><span class=\"token punctuation\">.</span>white\n    <span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">let</span> physicallyBasedLightFeatures <span class=\"token operator\">=</span> <span class=\"token function\">PhysicallyBasedLightFeatures</span><span class=\"token punctuation\">(</span>lumen<span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> temperature<span class=\"token punctuation\">:</span> <span class=\"token number\">4000</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">let</span> physicallyBasedLight <span class=\"token operator\">=</span> <span class=\"token function\">PhysicallyBasedLight</span><span class=\"token punctuation\">(</span>\n        lightFeatures<span class=\"token punctuation\">:</span> lightFeatures<span class=\"token punctuation\">,</span>\n        physicallyBasedLightFeatures<span class=\"token punctuation\">:</span> physicallyBasedLightFeatures\n    <span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> physicallyBasedLight\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">createPhysicallyLightingEnviroment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> enviroment <span class=\"token operator\">=</span> <span class=\"token function\">PhysicallyBasedLightingEnviroment</span><span class=\"token punctuation\">(</span>\n        cubeMap<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"rightPBR.png\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"leftPBR.png\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"upPBR.png\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"downPBR.png\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"backPBR.png\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"frontPBR.png\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        intensity<span class=\"token punctuation\">:</span> <span class=\"token number\">1.0</span>\n    <span class=\"token punctuation\">)</span>\n    enviroment<span class=\"token punctuation\">.</span><span class=\"token function\">setLightingEnviromentFor</span><span class=\"token punctuation\">(</span>scene<span class=\"token punctuation\">:</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Finally we can place our 4 objects: one basic plane mesh and 3 mesh taken from\nthe <a href=\"https://graphics.stanford.edu/data/3Dscanrep/\" title=\"Stanford scan repository\">Stanford scan repository</a>. These mesh\nare: the dragon, the happy buddha and Lucy. All this meshes will be rendered using the <code class=\"language-text\">PhysicallyBasedObject</code>. We take\nthe textures used to model the various material from <a href=\"https://freepbr.com\" title=\"freepbr\">freepbr</a> website.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">createObjects</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">addFloor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">addDragon</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">addBuddha</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">addLucy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">addFloor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> floor <span class=\"token operator\">=</span> <span class=\"token function\">PhysicallyBasedObject</span><span class=\"token punctuation\">(</span>\n        mesh<span class=\"token punctuation\">:</span> <span class=\"token builtin\">MeshLoader</span><span class=\"token punctuation\">.</span><span class=\"token function\">loadMeshWith</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Floor\"</span><span class=\"token punctuation\">,</span> ofType<span class=\"token punctuation\">:</span> <span class=\"token string\">\"obj\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        material<span class=\"token punctuation\">:</span> <span class=\"token function\">PhysicallyBasedMaterial</span><span class=\"token punctuation\">(</span>\n            diffuse<span class=\"token punctuation\">:</span> <span class=\"token string\">\"floor-diffuse.png\"</span><span class=\"token punctuation\">,</span>\n            roughness<span class=\"token punctuation\">:</span> <span class=\"token function\">NSNumber</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">:</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            metalness<span class=\"token punctuation\">:</span> <span class=\"token string\">\"floor-metalness.png\"</span><span class=\"token punctuation\">,</span>\n            normal<span class=\"token punctuation\">:</span> <span class=\"token string\">\"floor-normal.png\"</span><span class=\"token punctuation\">,</span>\n            ambientOcclusion<span class=\"token punctuation\">:</span> <span class=\"token string\">\"floor-ambient-occlusion.png\"</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        position<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector3Make</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        rotation<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector4Make</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n    rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">addChildNode</span><span class=\"token punctuation\">(</span>floor<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">addDragon</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> dragon <span class=\"token operator\">=</span> <span class=\"token function\">PhysicallyBasedObject</span><span class=\"token punctuation\">(</span>\n        mesh<span class=\"token punctuation\">:</span> <span class=\"token builtin\">MeshLoader</span><span class=\"token punctuation\">.</span><span class=\"token function\">loadMeshWith</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Dragon\"</span><span class=\"token punctuation\">,</span> ofType<span class=\"token punctuation\">:</span> <span class=\"token string\">\"obj\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        material<span class=\"token punctuation\">:</span> <span class=\"token function\">PhysicallyBasedMaterial</span><span class=\"token punctuation\">(</span>\n            diffuse<span class=\"token punctuation\">:</span> <span class=\"token string\">\"rustediron-diffuse.png\"</span><span class=\"token punctuation\">,</span>\n            roughness<span class=\"token punctuation\">:</span> <span class=\"token function\">NSNumber</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">:</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            metalness<span class=\"token punctuation\">:</span> <span class=\"token string\">\"rustediron-metalness.png\"</span><span class=\"token punctuation\">,</span>\n            normal<span class=\"token punctuation\">:</span> <span class=\"token string\">\"rustediron-normal.png\"</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        position<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector3Make</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        rotation<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector4Make</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">GLKMathDegreesToRadians</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n    rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">addChildNode</span><span class=\"token punctuation\">(</span>dragon<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">addBuddha</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> buddha <span class=\"token operator\">=</span> <span class=\"token function\">PhysicallyBasedObject</span><span class=\"token punctuation\">(</span>\n        mesh<span class=\"token punctuation\">:</span> <span class=\"token builtin\">MeshLoader</span><span class=\"token punctuation\">.</span><span class=\"token function\">loadMeshWith</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"HappyBuddha\"</span><span class=\"token punctuation\">,</span> ofType<span class=\"token punctuation\">:</span> <span class=\"token string\">\"obj\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        material<span class=\"token punctuation\">:</span> <span class=\"token function\">PhysicallyBasedMaterial</span><span class=\"token punctuation\">(</span>\n            diffuse<span class=\"token punctuation\">:</span> <span class=\"token string\">\"cement-diffuse.png\"</span><span class=\"token punctuation\">,</span>\n            roughness<span class=\"token punctuation\">:</span> <span class=\"token function\">NSNumber</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">:</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            metalness<span class=\"token punctuation\">:</span> <span class=\"token string\">\"cement-metalness.png\"</span><span class=\"token punctuation\">,</span>\n            normal<span class=\"token punctuation\">:</span> <span class=\"token string\">\"cement-normal.png\"</span><span class=\"token punctuation\">,</span>\n            ambientOcclusion<span class=\"token punctuation\">:</span> <span class=\"token string\">\"cement-ambient-occlusion.png\"</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        position<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector3Make</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        rotation<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector4Make</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n    rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">addChildNode</span><span class=\"token punctuation\">(</span>buddha<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">addLucy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> lucy <span class=\"token operator\">=</span> <span class=\"token function\">PhysicallyBasedObject</span><span class=\"token punctuation\">(</span>\n        mesh<span class=\"token punctuation\">:</span> <span class=\"token builtin\">MeshLoader</span><span class=\"token punctuation\">.</span><span class=\"token function\">loadMeshWith</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Lucy\"</span><span class=\"token punctuation\">,</span> ofType<span class=\"token punctuation\">:</span> <span class=\"token string\">\"obj\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        material<span class=\"token punctuation\">:</span> <span class=\"token function\">PhysicallyBasedMaterial</span><span class=\"token punctuation\">(</span>\n            diffuse<span class=\"token punctuation\">:</span> <span class=\"token string\">\"copper-diffuse.png\"</span><span class=\"token punctuation\">,</span>\n            roughness<span class=\"token punctuation\">:</span> <span class=\"token function\">NSNumber</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">:</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            metalness<span class=\"token punctuation\">:</span> <span class=\"token string\">\"copper-metalness.png\"</span><span class=\"token punctuation\">,</span>\n            normal<span class=\"token punctuation\">:</span> <span class=\"token string\">\"copper-normal.png\"</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        position<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector3Make</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        rotation<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector4Make</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n    rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">addChildNode</span><span class=\"token punctuation\">(</span>lucy<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The meshes are stored as <a href=\"https://en.wikipedia.org/wiki/Wavefront_.obj_file\" title=\"wavefront obj file\">wavefront obj file</a> (\nthe easiest file format of all time <img class=\"emoji-icon\" alt=\"emoji-relieved\" data-icon=\"emoji-relieved\" style=\"display: inline; margin: 0; position: relative; width: 25px\" src=\"data:image/png;base64, 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\" title=\"emoji-relieved\">). As you can see from the previous code, we use a class\ncalled <code class=\"language-text\">MeshLoader</code>. How does it work? It uses\nthe <a href=\"https://developer.apple.com/documentation/modelio\" title=\"Model I/O\">Model I/O</a> Apple framework to load the obj file as\na <code class=\"language-text\">MDLAsset</code> and then we extract the first <code class=\"language-text\">MDLObject</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MeshLoader</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">func</span> <span class=\"token function\">loadMeshWith</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> ofType type<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">MDLObject</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> path <span class=\"token operator\">=</span> <span class=\"token builtin\">Bundle</span><span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span><span class=\"token function\">path</span><span class=\"token punctuation\">(</span>forResource<span class=\"token punctuation\">:</span> name<span class=\"token punctuation\">,</span> ofType<span class=\"token punctuation\">:</span> type<span class=\"token punctuation\">)</span><span class=\"token operator\">!</span>\n        <span class=\"token keyword\">let</span> asset <span class=\"token operator\">=</span> <span class=\"token function\">MDLAsset</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">:</span> <span class=\"token function\">URL</span><span class=\"token punctuation\">(</span>fileURLWithPath<span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> asset<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We are almost ready to render our scene. The last thing to do is to implement the methods of the <code class=\"language-text\">Scene</code> protocol to add\nsome movement to the scene. This method will be called by a one tap gesture attached to the main view that will render\nour scene (we will see it in a few moments). Inside it we use the method <code class=\"language-text\">runAction</code> to rotate the camera around its\npivot, that we moved previously to have a rotation axis to move the camera around the scene.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">func</span> <span class=\"token function\">actionForOnefingerGesture</span><span class=\"token punctuation\">(</span>withLocation location<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGPoint</span><span class=\"token punctuation\">,</span> andHitResult hitResult<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">Any</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>camera<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span><span class=\"token function\">runAction</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">SCNAction</span><span class=\"token punctuation\">.</span><span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>by<span class=\"token punctuation\">:</span> <span class=\"token function\">CGFloat</span><span class=\"token punctuation\">(</span><span class=\"token function\">GLKMathDegreesToRadians</span><span class=\"token punctuation\">(</span><span class=\"token number\">360</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                                around<span class=\"token punctuation\">:</span> <span class=\"token function\">SCNVector3Make</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                                duration<span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We are ready to render our scene. Assign an instance of our <code class=\"language-text\">PhysicallyBasedScene</code> to a <code class=\"language-text\">SCNView</code> and see the beautiful\nresults of our work. Below you can find a video of the scene we created.</p>\n<p>\n        <div class=\"embedVideo-container\">\n            <iframe\n              title=\"\"\n              width=\"100%\"\n              height=\"auto\"\n              src=\"https://www.youtube.com/embed/yDMdAtv-3Bg?rel=0\"\n              class=\"embedVideo-iframe\"\n              style=\"border:0\"\n              \n              loading=\"lazy\"\n              allowfullscreen\n\t      sandbox=\"allow-same-origin allow-scripts allow-popups\"\n            ></iframe>\n        </div></p>\n<p>That's it!! You've made it!! Now you can show to your friends your physically based scene and be proud of it :\nsunglasses:. You can find this example with other scenes\nin <a href=\"https://github.com/chicio/Exploring-SceneKit\" title=\"Exploring-SceneKit repo\">this github repository</a>.</p>","frontmatter":{"title":"SceneKit and physically based rendering","comments":true,"authors":["fabrizio_duroni"],"tags":["computer graphics","physically based rendering","swift","ios","apple","mobile application development"],"date":"03 Jan 2018","description":"Let's try to build a scene using SceneKit and its physically based rendering features.","math":false,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/12d0892d46967ae2bc6f295a37ba7f0f/f4e40/physically-based-rendering-scene-right.jpg","srcSet":"/static/12d0892d46967ae2bc6f295a37ba7f0f/2e9d5/physically-based-rendering-scene-right.jpg 750w,\n/static/12d0892d46967ae2bc6f295a37ba7f0f/37167/physically-based-rendering-scene-right.jpg 1080w,\n/static/12d0892d46967ae2bc6f295a37ba7f0f/a1598/physically-based-rendering-scene-right.jpg 1366w,\n/static/12d0892d46967ae2bc6f295a37ba7f0f/f4e40/physically-based-rendering-scene-right.jpg 1500w","sizes":"100vw"},"sources":[{"srcSet":"/static/12d0892d46967ae2bc6f295a37ba7f0f/b6c78/physically-based-rendering-scene-right.webp 750w,\n/static/12d0892d46967ae2bc6f295a37ba7f0f/a9803/physically-based-rendering-scene-right.webp 1080w,\n/static/12d0892d46967ae2bc6f295a37ba7f0f/7a617/physically-based-rendering-scene-right.webp 1366w,\n/static/12d0892d46967ae2bc6f295a37ba7f0f/9a31d/physically-based-rendering-scene-right.webp 1500w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.4546666666666667}}}},"fields":{"slug":"/2018/01/03/scene-kit-physically-based-rendering/","readingTime":{"text":"13 min read"}}},"site":{"siteMetadata":{"author":"Fabrizio Duroni"}}},"pageContext":{"slug":"/2018/01/03/scene-kit-physically-based-rendering/"}},"staticQueryHashes":["3076394108","3309278767","3736063423","4159577854"]}