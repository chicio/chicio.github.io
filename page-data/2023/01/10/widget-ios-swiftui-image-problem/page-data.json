{"componentChunkName":"component---src-templates-post-tsx","path":"/2023/01/10/widget-ios-swiftui-image-problem/","result":{"data":{"markdownRemark":{"html":"<p>In a <a href=\"https://technology.lastminute.com/widget-ios-swiftui-configuration-intent/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">recent post</a> on the\nlastminute.com official blog, we presented our FriYaY project: an inspirational iOS widget.\nWe were so excited to have our first widget in production that we <del>forced</del> asked all our colleagues to give it a try.<br>\nUnfortunately, for some people, the widget was loading in a broken state: as you can see from the image below,\nthe assets were not loading.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1140px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6fd819099174f3c0a8dd99b845f2eb4e/f4296/widget-image-problem.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 108.0701754385965%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAWABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAUDBAL/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQT/2gAMAwEAAhADEAAAAd+erFPDMl6INHGJn//EAB0QAAEEAgMAAAAAAAAAAAAAAAIAAQMRBBMSFCH/2gAIAQEAAQUC6UK044mY498iU/s5hT7HWRTzvS//xAAYEQADAQEAAAAAAAAAAAAAAAABAhADIf/aAAgBAwEBPwGaoFHJ/8QAFREBAQAAAAAAAAAAAAAAAAAAEAH/2gAIAQIBAT8BKf/EAB0QAAICAQUAAAAAAAAAAAAAAAACATEQITJBkaH/2gAIAQEABj8CpuyVk0OBizb6NOP/xAAeEAADAAIBBQAAAAAAAAAAAAAAAREhMWFBcZGx8P/aAAgBAQABPyGW3B2vU8ViCW5OR0cR328ehEY0PJh87FITTc0+BK6+T//aAAwDAQACAAMAAAAQoD+8/8QAGBEBAAMBAAAAAAAAAAAAAAAAAQAQEUH/2gAIAQMBAT8QxoIjs2f/xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8Qgwn/xAAbEAEAAgMBAQAAAAAAAAAAAAABABEhMUFhcf/aAAgBAQABPxDAPQKxjxhEWkGobd5RtbKVSFMqMFdgsw1p2FrP1BIvpqFTYOsBhOVr2P/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Widget not loading\"\n        title=\"\"\n        src=\"/static/6fd819099174f3c0a8dd99b845f2eb4e/0470c/widget-image-problem.jpg\"\n        srcset=\"/static/6fd819099174f3c0a8dd99b845f2eb4e/6c669/widget-image-problem.jpg 285w,\n/static/6fd819099174f3c0a8dd99b845f2eb4e/882a4/widget-image-problem.jpg 570w,\n/static/6fd819099174f3c0a8dd99b845f2eb4e/0470c/widget-image-problem.jpg 1140w,\n/static/6fd819099174f3c0a8dd99b845f2eb4e/f4296/widget-image-problem.jpg 1146w\"\n        sizes=\"(max-width: 1140px) 100vw, 1140px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Widget not loading</figcaption>\n  </figure></p>\n<p>We were heartbroken. We tested the widget carefully before going to production,\non multiple iPhones and iPads with different iOS and iPadOS versions, even with the iOS 16 Developer Beta build,\nand we never had this behaviour.<br>\nSoon we found ourselves deep into the code, trying to catch the bug. There was not a\nsingle line in the Xcode log that was pointing us to the right solution.</p>\n<p>We tried to:</p>\n<ul>\n<li>debug the REST services, to understand if there was a bug in the API</li>\n<li>debug the Network Client code, to understand if there were some errors in the deserialization of the JSON or in the image download</li>\n<li>debug the UI, to understand if we were making mistakes with the Image display code.</li>\n</ul>\n<p>During the investigation we noticed that both the images bundled inside the extension\n(e.g. the one shown in the widget picker before installing it) and the ones downloaded from the API were not working.\nWe were able to replicate the issue only on iPhone 11 (A13 Bionic Chip) and older.</p>\n<p>We finally checked the general system log using the Console.app, to better understand what was happening at system level.\nTo avoid having noise in the logs, we created and empty app project with attached our widget extension.\nWhile running the test app on an iPhone 11, we finally found the problem.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1140px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ca190d06a05c288f14bec41457e96083/1fec9/debugger-widget.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.94736842105264%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACqElEQVR42o3R247bRBzH8bxDk4J2k03iOAfb8Wl8nPH4HLtJ20WUUFai3S4geKnuWoKb9hGhGmV+VdyqVFxx8dF39Ldn5JEH+7q+bXbNu6po7tv60CVx3iU071iUdTTkfVmUdiz+XFZ1RdZ0Oa87zpuuLp50h/b5W06L96FHXw8Oh+/fvzzeYN8+Q8Yr+G6MyE+Q0BzW1kPgMSS0gE8oOCsRhylYlIHFZzk4LZAmFdKkREDou0HTXt8fX9yg3T39x3OY0Fau0NdERH4m1PlWmHogEloLY+MJFlfCJ1wQm4mgLxXnPcRhfwdeCkMjbwfV/ofux+MNqrwRxArlZmHA3DigPsda0WHrBCxMsd04fQMnhm9HCNwY7tY/k6FLRUQYTM15GJTVofvu+QvU5RNhk1rOlxS6VcCnz6CsGAy7QsyvoZlFXxLu4fgt/PhpX8MupUV2wnR3WGn0YZCnZberWpRFKyz2k5w6Ryy9I+zsFhfGNdbhDfz6V6j+SwT1b7DSW5j8FUhxB1L+Ait9LbfJz8Jgr6BYh4dBnlVduzugKhoRe1Q6uoOzJOTQF3q/TqMU1sZCFmeISIzQjcCjFDzkyGkuqc9E5EbYrs3zF1ZdU+9RFa3w3UQuFxaMjYcoyKGtCUwjBGc7bDUfLK7guUkvDoueazN5/pGqYmI62fx7YJnvhGdT6TuJtI1QLhVLKleaVGeGXC0suZjqvflEk8v59ovz87VqC2KE8NZOf+WH/sp582Glaid1sTot1fVpoSxPylw9zabKaTKena4m89607+wr/fzDfKpgPlncD1Je/FVXLfK0xvRqhsvLC4zHlxiPx59Mxpj8D+f3Li+u/hwYuhlZpvO7oZtvvnn87d1wOLwbjUZ3o+Enw97wq/5XP38zGo7+GD56HH0EugBd3BeQ0toAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Debugging the code with Console.app\"\n        title=\"\"\n        src=\"/static/ca190d06a05c288f14bec41457e96083/b5cea/debugger-widget.png\"\n        srcset=\"/static/ca190d06a05c288f14bec41457e96083/0e2fe/debugger-widget.png 285w,\n/static/ca190d06a05c288f14bec41457e96083/432e7/debugger-widget.png 570w,\n/static/ca190d06a05c288f14bec41457e96083/b5cea/debugger-widget.png 1140w,\n/static/ca190d06a05c288f14bec41457e96083/09ede/debugger-widget.png 1710w,\n/static/ca190d06a05c288f14bec41457e96083/d50e7/debugger-widget.png 2280w,\n/static/ca190d06a05c288f14bec41457e96083/1fec9/debugger-widget.png 3808w\"\n        sizes=\"(max-width: 1140px) 100vw, 1140px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Debugging the code with Console.app</figcaption>\n  </figure></p>\n<p>As you can see from the screenshot, the widget was failing to archive because the image used as background (what we\ncalled inspiration image in the previous posts) was too big. This was causing a memory leak\n(see <code class=\"language-text\">CGImageCopyResourceImageSource</code> logs) that prevented the code from opening the images causing\nthe \"broken widget\" state reported above.<br>\nAfter some searches we found <a href=\"https://developer.apple.com/forums/thread/710745\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">this thread</a> on the Apple Developer Forum,\nwhere they were suggesting to reduce images' size using some UIImage extension code.</p>\n<p><em>So how did we solve the problem?</em> We simply sized our images in the right way <img class=\"emoji-icon\" alt=\"emoji-laughing\" data-icon=\"emoji-laughing\" style=\"display: inline; margin: 0; position: relative; width: 20px\" src=\"data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAYMElEQVR4Ae2bBXQcR7b3f7equ4dHI44hssMcO/u8WWZmZsjSW2Z+nH38lpmZmTGwTFleOw6YLYNsi0dDDVX1qT71OVJ8bC8GPrjn3DNUF37/ru6aao34//b/7f/b/9Mm3Mh2KahLntIY08aepUWdKeLWiXLDgUjdQhlAQSdzrumsTDone42z24xW13/kw3PjgOVGNLn0xoGW3Y9vbIgCdy8iuXOoOUciqetQQrQKnRYtyilRCICzOGfFinEGY1OTutQlrpkariVxP0wyufyUT879HnC36Bnw00dROqXU9wAX8JiwKLejpKpBQZUkUovoIhJYENAaEAHngOXnxgAOXKZwqXMusWkW2y5d20p77meS8Znd3flvAF3+SiaLTf/FFk8SnD3W91Cl5VlSlYvCsq5S0wUVOlSw6AWFKpVQ1QaU+qEyhEQ1CAoAkMW4ZAHaU9CdxbbmsN0uNrbYTLCpwIKJ045puZb7rTXuPdeNz38ZyPgLTb53V/4iW7O6sbFacK8MqureYU3XVVmHUnaEoUB/P2rkTNTwBqR+JlIZRnRp0QvHmHwOZ+JF7+Lak7jmNuzk77FHtsHsLGnqcB3BdkyaLphm1rKXtWJ5LfA7/gKTbY9v8OfYmZ+ck71P6ntGsSyvDuvBat2ni7oCuiio0ZNRY3dGjdwGVRqBQMAACnDuBNc1BSJgAQ1kDts9gj1yFXb8h9jD+zA9h2mDmTe9tJkd7HXcf6/72Pz7AXdTXQPk50+gNhbUXxPW9SVBI2zohpKw4GB0mOC0+6FW3REVVgC7BCwuBwdwxy+78jMRcLL0iMKmbezEj8l2fgsOT5LGgpmzLptL59Km+ch41vyX236CBcDdmALI7x9WHR5p6LdFjeABwWBQCeqCKmnUqZsW4R+GKq8CkmV4HMifUtId9XRZBIiwnQmynV/C7voVtmvImo5sOmsnc9k3jsyZF2z4UmsScH99AXL44QH94WIjuLseCgtRXaCvRHjW/ZG1d8uTWe+IuGWOY5QROQrbHau5FTlcLgIKB7j93yO9/psw3yVpOsxUGvfmsu9OzpinLIvw1xNAvvRQ+m7d3/hAZVA9UA9HUVBXSF+F6LyHo4Y34sjAWhB3DEr5w5XdCWbDSnWcgFIIAXZyM8nWz+Pm22RNi5lMkva0/fovZ+ee/rAvMw+4v4YAAqi9T268qTKknxkOh4WoX0N/iejshyJDF4CJl8FFuFHNuWUhdAE3tYXkui/DbJdk1pBOpnF7yrx33UfnXgJYwP35AuTwO57c/4y+hrwhOimsRAMR1BXRGXdHRm8PtgtYUAIIN405sA5QoEq4wz8l2f5daFqSmYTkUNqen3MvO/2js+//QyIEfwj+J4+qXFCruH8OBqJK0Iig4ghWnwkDGyCbAxwowAo3rTmwgI19LwSr95OZawlshE2o1NL4nxd7v+oOn2tvOZEIwYngH7Sawlg9vDTqC1eF/RpVEoK+PtToJpAO2AwEMNx85gCV+p4ImhNkWRPfK71w1VjCpYsMj//aQWJyEf4kAV5/t74HFapyX92vRddCggqo0bOQqATpAiAg3LzmQIyDqIQaPZug90twIbZnpdDN7usZvvaJ+S8C7o8TIId/zgVUaxVeHvaFBVULoaigWl/0tZDOAxbIUxZCpBTi4gx6GTjLjWKioBgghQDXTSFOyQ3SBKprFn07ZE18z2GfLdS68csXWS571xYWlkU4sQAK0M86v/8BhZpsDBoaXdUEBVD1EUQJZB0QB0pBqJmemGHneJNzzhikvrYfnOBaMaSGv4qFGqkWQITm/mmu3T7NaWN1BkfqSzWsBSeILqD6Rgi6TahqXENTaOuNnuVdW2Y/l8ObEwkg3s8aImpU7FNVpRBIKUAXNRQCKA5A1gVScIAFqRe5/Pv7+Pc3/IzzTi9y/vknce+7rec2tz0Z6S/g5ruQWP4sixTSV/Ji8vMrdnDZ9/Zw9dWH2Lqjxz++7HY87pKzcd0euUFmoTAAhQhtMkwpQFVM0KjET11k+sr1U5ic0ZGbOoYA+s13qp1frqjb65pCl9RSI8UiogMwbbAJueOa8zzoUXfmIY+6I9OHZrnqx9t47eu/xwtf8nW+9tnfgUuRAQUqzWP+CFd5jEt9Dp/L5/S5fQ1fy9f0tW8YZ9qIDn2vEC317hk8i2cCdM7I8QRQ3seq8oCwqotSDlDFAAkUSkcgBojBrfC4R8Xu4tX/+QBe9m/PYdVglYrNmDkwywfffxUveNllfO+b26AMVK2PObH7MWV8jI/1OXwun9Pn9jV8LV/T175hLDFI5ntd6rkY4Bk8i2ci5zueAAKoU/uJKkV9Dylqgkgj4aJrIFRADNnRnsLCLLX9P+Qe96vyD+96MWdeeAr1IGN9f4Hm4Tne+vareM2lP2LhcBPqgEkhO8pNCnX8GD/Wx/hYn8Pn8jl9bl/D1/I189ij+iGGvGcJc4aixjN5tpxZjnUNEO+vuHX15FKB83VRIBIkEJTOY3xBl3FMi1Oi8S2sGxzhhW96Ap/6n2+w65dXc+pwRLNn2fKbw7z4H1r826suYPXaArRTbmCVkIPb5vmn/9nC/FSbU4Yi6kVFp5Nw1p038rhXPYBaexcyfgQsx7csAEBpwQV4BjyLZ/Jsz7mstT1ndccSIFhfVheEJVWhqJFIg85v4pkEbHycJS7PZxxyaC/1+iRPfP5ZvOXle9GdHrWGphgJv93V5EMfv5Z/eOUaiA24FeElvfjZASb2N7no1CKDZUUaW8Lhms9FZfIqaHYADSLLNY82MWDSpZ618Qx4Fs/k2YDdQHa8GaCGi5wjBSUSKq8iogS8YyBrgSoctTEx4AxkGSj/aMDMUQmbEAgWRyUSjFVUQsfQqgoodcOZ5ACl/GdUwmkaReVjmIkdBEIl3Q2zLUiBQIPVEAQgeoUguZkOkIFSiLJLDKHCM3k24OvHOwWU92JRzpBQQAv4x0AtF0h7oNJ8qF1y6/LngGEpZiDkB9+Y4MD+NusHNUnqODIZs+nOa3ni00+FmUmONpqp/4y5BcuRzYconlQgCBV7FnP4XHe5zyDMpEsCYyBNAJUfHLXckzUAIHnvOYtn8mzkg48WQHJXRSWjogW96IhCoQABB2DBuOWt79HTsCBQD7ns69N8/AuTjJYUva5lqmu48H6n8tBLTqEyeQQSd/S2GRJHpT3Pc//+PL78kTJXX7abaklTDhUf+PQkcQr3fsAgLKTQcyv6EcAcox9BobCiPAtm0T0boFbwOsUNLQo0/aIBAUEAwLEyBhy5O3D5+zUNkeL975vgfZ86TMla4k5CVinw0JdfzCP/9hRqhw9Bq8fxzH/mx/ixPsbH+hw+l8/pc6MV1I53HXDLfTqAnEFANHg2IDrOMpgrI64skp/7zuUOYHN3R7mFIixMpbz638f50rem0L2UqKC5zcNO5yWvuy2bLhBKu/ZDO17u8eg8OYsf48f6GB/rc/hcPqfP/er/HPe1oMgN+3Er+sHmdZbe9zzePRsgxzsFALTSiJPlvIgFp8A6jmmhQOp47qV7uXZHi3PXV7jDPVdz70ev46SToDRxCBa6YFR+cPLEHH8xITaE+4/QqJV4+FNWc/v7ruayz+7lJ1cc5Iofz3DgUMLHXnsKwHJfDpDllwrA2WV9BDwboFdO54DlcABlrYpxDmcdOJPD50rrlb3nR80CWrPxrqu4xyPL3Os+A/QPCcXDM6idPchMvmmyf/o+v9mm1OmxrlbkSS86mQc+bi2XXz7D9FQnL2zysWARlAPsCjXNEoPLZ7JnAxS5LMfcDGUpTZc5MBbckluWVVYAWqCaF0iWcj3rGQ20huLMJLIzAZtPy0AB5o+/PetWLsqATVDNlHKrRakS8ZhHlDAmgokmBA6KAghqwWAzVgiSzw5rPAueKbM0T3Q/wAG0jZkesgHGWnRmMSZDlF5uMISka/nBT7qcOhZx2lkB1BTVbA5auSAuXymUAHY5Vji+HWdhQS2vGJIYSs0YCkADmMn4zS8zOh3LHS8uolDYbDnYWYMzDmOsf6SdmOmjKxx9CrCQshcDWIfFoY2DwCw339B88BPzvPPTM4wNhIytCTntjJALzypw1uLj2Frtx0BJwHl3y7twm7uzy+8BaHJYBWrFeyqfbQ7oOtK5jB3bDddfn7L12pidu1LGD3eZX4D3/OcqbnVxCWYtQF5nicE/YnO23I51Clgg29l0u89LLS4DrF1eNvPeCKHVgT6r6EsN+xcb2bZZ+GYkVOvQ6IsYOSnkpFUBq9cErBnVDA0HNBpCqawoFSAIhCACwpw2s6Q9R2YsnZ6j3XLMzhoOH7YcPJRy6JDh4ETG1JGU+fmUbssRGkcthKFSRNta2okC7UDlJDhw1ufGJeBSi2dbcSg4lgDmp/vjnfc/O4iDzBZwesXf8MEKKGc5/YwCDZ1SWyRee9uLmG+2mT64l9Zch3372uzc2cNmoLUQlAStISxAuQRR5F8HXgR0KDiLB8ekGSaDXs/R7eUbROPIumCNIwghKjiKlSqj6xoMrllHgZjmlqsZLCnWrQ8hdSCAyjEdOZklS2zs2YDsRAIkX92W7H/V7WvjhZgzSB0YAAciKAUkcN7ZRTKBpK+fCx/7cpRNyDoLZHFCe2YPc1PTdJrzLBzZSWumRdyNSZIOSbftd3dYY7A2xRgA0EGAEp9fE5aK1IeqRFGRYjmiNjRIfXA9pXqVvtHVFOsjhMUSYbmfmUN7uGLzy2k0NGvWBpCkN/yGmYFncDEsdNS4ZwOS4wnggGSiQ/dgM71qoKfOyBKNsjm/AxTQcZxyVkR1uMSOA0e408I0q1aPYStlwiiieN75BEFIEIYo5cAKgVakaReTtsjiHoKgBEwGAKLBYQFFWKqggyqiQ7AZDkdq/NiULEnoxF1MkhFV+tj+2++zbzbmPhuG0AMKPJ4GUnD5NSBLHbZn8EyeLRfAHU+AFOhdttv++Lwx83gXW2VTg86AUIMsJQ0HFRtvV+eTXzjMFd/4OE94xqsZHBlFrAMylIIoEIqFEkEYUCgUvThEhQJhEKEDIVSCcy4vDMZBmmZkcUac9EiSmDRNieOEIIlJMARSpFgqYx3s2rWDH3znS2TAne5Rg9SCCMqBtYCxmNSxyIBLjPVMQA9IjycAgAG6H7+mtfWSDQPbhhv2bGIHJXITEMG1Mx76kH6+8505tv3qh7zhwH7OOvdWbLrNnTnn/FsxPHwSxVIJrcBhUCgCHaCcRWHQBOggRACALMuwJgNj0BqiMEAUXjhqNUWSpHS6XcbH93D1737Bb371I3Zdt5n48EFOHatx13tWoNkFBTi8sDgLJAbXscwstumZgC5gTnRP0AKdXbO0fzWRft22DVlsyb8YAQ4EmM84+7YFbn9xnVVOiGZ384vvfom3vvbv+YeXPol/ftXf8qH3vYErL/8aB/btw/gxxTL1ep1SqUQURQjLFgR+lhQWYauLXkPriDixbL/uar7+1c/yrrf+22Lep3LpK57Kh975X1x/1RX0J5OMiuZBDx2g2O8gdssE1kHPkvUctmPwLJ4J6AD2RLfFXa7S/Ft/2fneHcbCx/XV7BpbtkhBsEXIz2t0r8eTnzfKa1/aYaQmJEqYTRKm27vZ/dvdXPPrnyBBSLFUoFIfoNFoMDg4TN/AMIViiVKxQjGKAEer1yPudei1W8zMTjI9NUlrvkl7YZZeLyGwCcUgZqgQcPZgQH8UkXUM2WlFHnNJP266DUqBcVgLJA7rD9yCpTVnD3gWYB7o/jF/GEmB1k/2m+mfjqefuXe/eqmqKlRBISWH0/nOajbj7E0l7vaIUTZ/7RBnr40QBe1Us5A4mgm0soSFtEd7fpbZmYwj2zWpUZgVW3LnQOUbJK0sgRiK2lCLQlaVFNW6plbQVIMy9YJQCpbuMWxvWx73orWUayluzoII1gGJxXUtprPorQzP4FmAVs7GHxLAAQvA3L/8eOHKW60K7jNSMufpkkBPUIFGAgco1FSHRz93kIN7ukzvXeD0k0OGA42zEBtLmmpi5+hljsREJBmk+dnk3QIAWgQlEChNKCGFAMJAKCpFUUMQCJHyYxztxLHnSMrFj1jFxfcs4MabIArcUkIbL131zbxhatJs9QzAHLDwp/xxNAbmrp1k6sObk/e9qKb+R5VUIShaJBJcpJAA6DrK9TbPvHQd73jlLsanepy6ViiGQkUUTgkYsDicA5vD+0d3rD9IAoEGEVCy4maGg9Q5Oj3H9kMpay4e5pHPGyKYmgMjgMVm4HoO27Zkc5Z4Jot9754BmMuZ+GMFsEATmH7br9pbb7NWf/pOZXWJFAQVCVYLSgmiBTeTMjTa4Rn/eToffs0utu1vL86EiHJBEWoQfYzbXwDu2DvB5efLN52SzDHfsWzftwh/m2Ge8KrVlFoz0DEggsuXO+en/XxGNpvx8/H00753YDpnsX+KAAA9YHa+R/nl325/6VNVdcppodxZBYIACCilEAQ31WX1iOM5/3MGn37zOFs3z7D+pICBvoCiXt5HKFnZxbHvbKsVF3JnoJM6Dk8bJuYd5z/kZO5/yQCV5gw0U7BL8Da2mAWLm83IpjN27U9/+PJvtb803+MwMAv0/tyfyITACLDmvqeF577t/tVXjJ4cnRsOafRghDQ0qixIKFAUpBHRKjT48Tdb/OrL+yjFKSOjAY2KJtKAErSAHKvyim/d1jh6Kcw1Mw5OG4KRMvd80smcsymgODkLHQMpS/BdD24w0ynplOHw/uSaF3yz9bpv70yvAQ4AR4CU45jmxGZzlz2z1k603O7bDalzioEaEA2S00h+aEkNURYzdqsK59zhJJppwPiuHlOTCXFmEcCK4PBOfl2ADMgy6MWW+bbh4NSizxh61QIbHryWhz1rDWtX9YiONMEDZ0DHYnsON28xMxnptGHyQLLz76/svPkb25JtFiby6d/jBBbwh60DzGQQfXVbHAaKN/zLXXn+auPOxYCkAS6xqJKGTJA0I0pnGa1GPOBpDdoPH2brzxfY/vtZxvd3MZMxGggUKAUOMMZhrOC0ENUjhi+ssWlTP+dcVKYQ9Yimp6CXQexw2aJ3lq70trV09LPJlIkD6TWv+X7n7Ys9bsvgMDCT935C0/xxlgAus7jtMybZPmuu2dCv+/uUrBPrECfgyK/YQAaSGIJ2l7KOWX1OtDgjBjl/0cc2DjF6dh+N9VXvDJ7ax9qNg5x7lxE23m+UOz5klHNvV2btSEKp2UTPtKFrcD0HcT7lFyx2zk/7jHQyY/t48qNXXtl+77e2J9t7GRPAJDD31/qd4Eqx+oGRAEY3jOpVr7ln5X63WR89qjwYFBgI0DWFKiukrCEEVVKgBNEOIg0FjQ1DbFFjJcDl8otxqCxDpwZJMkhS6IFzFhKwiYNFd4n1Rx2zYGDG0JnO4qv2JJ/7x8vb3776iDmQH/kjOby5MX4rHAB9wDAwdHqfXvWki0rnPubC8JGrRoLzg36NqgdI1QuhkaJAKCgFRAJaQeDya4cDJwBLz63gjANDvjUEa3LweAnctS12wS9zlokj6dWf2Zx+/mO/7W7dMW8mgKnc54Hsxvy1uAbqwKD3/gKDF67So8/aVL3dHdYH92sM6bW6qpBagC4pWHRVEIg8uAItkK8IN1j/rQMLZA5nLCSC7TnoWcz/nvaZX+qYmzb7f7In+9Z7ftX62eYJc3g2ZhpyhyZgbop/mZFchD6gH2isqzJ04dpw6AkXli/6mzXBXYb75SxdDkRVBQoKVVRIKOBd57MiAAAysJb8yLul5a1noWuxHYvpGDc5667/9YHsB5/Y3Pnt5v3p1N5W/g0PZoH5HN7dlP8zJEAJqOViNIDauj76x/p17R6nlU656zp94brB8MK+Cmt0QRV0JOBdgwTqht/6MgsGSBzGe2zj+TYH9k6nm7+/12y+cmd39/isWdg7zyz5XiWHXlje5d08FuQCrAHOBm4N3Lm/wIPOHtKPu/t6/dTn3aHyd+9/aP3Nlz2l77O/eW7j+9e9cOB3O182tH3fKwbHvfvn/j3/mR/jx/oYH+tz+Fw+Z5777LxWHQhuKf81JkAElIBK7uX8dbESUKiXKNVCHZUCokKIBAodagBIDWQWE6e4bkaykJqk2aXbzoiBHtAFOkA79+V7e7cwE6AA1IERYAw4C7gA+BvgdsAdgTsBdwPumrt/fqf8s9vlYy/IY8fyXPU8t/B/gAmggdKKFWMVsBY4FTgNONMD5n5m/t6p+ZhVeUw9z6FvLHC5acRY3u7nj+rY2yFs7ln+6G7saf6/AFHyMdKkiXe1AAAAAElFTkSuQmCC\" title=\"emoji-laughing\">.<br>\nUsing the <a href=\"https://developer.apple.com/design/human-interface-guidelines/components/system-experiences/widgets/#specifications\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WidgetKit Human Interface Guidelines</a>\nfrom Apple, we gave to the images the size based on the width of the widgets on the various iPhones.\nIf you can't approach the problem in this way, you can still use the extension code for UIImage mentioned\nin the Apple Developer Forum above.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">extension</span> <span class=\"token class-name\">UIImage</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">resized</span><span class=\"token punctuation\">(</span>toWidth width<span class=\"token punctuation\">:</span> <span class=\"token class-name\">CGFloat</span><span class=\"token punctuation\">,</span> isOpaque<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Bool</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token class-name\">UIImage</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> canvas <span class=\"token operator\">=</span> <span class=\"token class-name\">CGSize</span><span class=\"token punctuation\">(</span>width<span class=\"token punctuation\">:</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token class-name\">CGFloat</span><span class=\"token punctuation\">(</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>width<span class=\"token operator\">/</span>size<span class=\"token punctuation\">.</span>width <span class=\"token operator\">*</span> size<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">let</span> format <span class=\"token operator\">=</span> imageRendererFormat\n    format<span class=\"token punctuation\">.</span>opaque <span class=\"token operator\">=</span> isOpaque\n    <span class=\"token keyword\">return</span> <span class=\"token class-name\">UIGraphicsImageRenderer</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">:</span> canvas<span class=\"token punctuation\">,</span> format<span class=\"token punctuation\">:</span> format<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>image <span class=\"token punctuation\">{</span>\n      <span class=\"token omit keyword\">_</span> <span class=\"token keyword\">in</span> <span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">in</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>origin<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>zero<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">:</span> canvas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Conclusion</h2>\n<p>The journey into WidgetKit during our FriYaY is not finished yet, and we are planning to introduce more new features\nin the near future, sooo stay tuned!!! <img class=\"emoji-icon\" alt=\"emoji-heart\" data-icon=\"emoji-heart\" style=\"display: inline; margin: 0; position: relative; width: 20px\" src=\"data:image/png;base64, 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\" title=\"emoji-heart\"></p>","frontmatter":{"title":"Widget iOS: how to fix the image bundling problem","comments":true,"authors":["fabrizio_duroni","marco_delucchi"],"tags":["swift","swiftui","ios","apple","mobile-application-development"],"date":"23 Jan 2023","description":"Discover how we had a long day debugging WidgetKit problems with images.","math":false,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/f61042d69d6e4d48fd8244bcd4a6d121/16129/widget-image-problem-featured.jpg","srcSet":"/static/f61042d69d6e4d48fd8244bcd4a6d121/a021a/widget-image-problem-featured.jpg 750w,\n/static/f61042d69d6e4d48fd8244bcd4a6d121/5ab35/widget-image-problem-featured.jpg 1080w,\n/static/f61042d69d6e4d48fd8244bcd4a6d121/16129/widget-image-problem-featured.jpg 1146w","sizes":"100vw"},"sources":[{"srcSet":"/static/f61042d69d6e4d48fd8244bcd4a6d121/4e544/widget-image-problem-featured.webp 750w,\n/static/f61042d69d6e4d48fd8244bcd4a6d121/3f071/widget-image-problem-featured.webp 1080w,\n/static/f61042d69d6e4d48fd8244bcd4a6d121/f8c26/widget-image-problem-featured.webp 1146w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6980802792321117}}}},"fields":{"slug":"/2023/01/10/widget-ios-swiftui-image-problem/","readingTime":{"text":"3 min read"}}},"site":{"siteMetadata":{"author":"Fabrizio Duroni"}}},"pageContext":{"slug":"/2023/01/10/widget-ios-swiftui-image-problem/"}},"staticQueryHashes":["2055070849","3076394108","379746230","4028829600"],"slicesMap":{}}