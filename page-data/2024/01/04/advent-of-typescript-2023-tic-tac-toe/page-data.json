{"componentChunkName":"component---src-templates-post-tsx","path":"/2024/01/04/advent-of-typescript-2023-tic-tac-toe/","result":{"data":{"markdownRemark":{"html":"<p><em>Tic tac toe, another classical kata game you can find at a coding dojo. A game that is easy to implement with\nfunctions, variables etc. becomes a real challenge when you try to implement it using only types.</em></p>\n<hr>\n<p>This is the first of the four challenges I liked the most from \"Advent Of TypeScript 2023\" by <a href=\"https://typehero.dev\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">TypeHero</a>.\nCheck out the other challenges I liked <a href=\"/2023/12/29/advent-of-typescript-2023-favourite-challenges/\" title=\"advent of typescript 2023 challenges\">here</a>.</p>\n<h4>The problem</h4>\n<p>\"Tic tac toe\" is a classical game used at coding dojo.\nLet's check the rule briefly explained by the guy from TypeHero:</p>\n<blockquote>\n<p>Tic-Tac-Toe is a two-player game where players alternate marking ❌s and ⭕s in a 3x3 grid, aiming to get three in a row.</p>\n<p>fun fact: Did you know that tic tac toe is widely considered to be the first computer video game ever created?!\nThat's right! A S Douglas implemented it all the way back in 1952, the same year as the coronation of Queen\nElizabeth II.<br>\nSolving Tic Tac Toe:\nYour goal for this challenge is to use TypeScript types to encode the game logic of Tic Tac Toe. Eventually, every\ngame will end with one of the players winning or a draw.</p>\n</blockquote>\n<h4>Implementation</h4>\n<p>The exercise gave me some data structure to use as the basis of my development.\nThey looked like the domain data structures of tic tac toe game.\nIt is interesting to see that the guy at type hero defined also some types for the position on board as string, not\nas coordinates.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeChip</span> <span class=\"token operator\">=</span> <span class=\"token string\">'❌'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'⭕'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeEndState</span> <span class=\"token operator\">=</span> <span class=\"token string\">'❌ Won'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'⭕ Won'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'Draw'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeState</span> <span class=\"token operator\">=</span> TicTacToeChip <span class=\"token operator\">|</span> TicTacToeEndState<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeEmptyCell</span> <span class=\"token operator\">=</span> <span class=\"token string\">'  '</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeCell</span> <span class=\"token operator\">=</span> TicTacToeChip <span class=\"token operator\">|</span> TicTacToeEmptyCell<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeYPositions</span> <span class=\"token operator\">=</span> <span class=\"token string\">'top'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'middle'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'bottom'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeXPositions</span> <span class=\"token operator\">=</span> <span class=\"token string\">'left'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'center'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'right'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToePositions</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>TicTacToeYPositions<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>TicTacToeXPositions<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTactToeBoard</span> <span class=\"token operator\">=</span> TicTacToeCell<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeGame</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  board<span class=\"token operator\">:</span> TicTactToeBoard<span class=\"token punctuation\">;</span>\n  state<span class=\"token operator\">:</span> TicTacToeState<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">EmptyBoard</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">'  '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">'  '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">'  '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">NewGame</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  board<span class=\"token operator\">:</span> EmptyBoard<span class=\"token punctuation\">;</span>\n  state<span class=\"token operator\">:</span> <span class=\"token string\">'❌'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Why did they define the position as strings? Because the input of the <code class=\"language-text\">TicTacToe</code> type I had to implement receive\nin input two parameters:</p>\n<ul>\n<li>the current game, <code class=\"language-text\">TicTacToeGame</code>, composed by a <code class=\"language-text\">board</code> and a <code class=\"language-text\">state</code>, that described the next move or the end of\nthe game (who won or draw)</li>\n<li>the next move to be applied (based on the <code class=\"language-text\">state</code> that describe also the next chip to be calculated)</li>\n</ul>\n<p>Let's take a look also at the test cases provided by TypeHero to check if the implementation is correct, that show\nthe configuration I just described.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">test_move1_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>NewGame<span class=\"token punctuation\">,</span> <span class=\"token string\">'top-center'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_move2_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_move1_actual<span class=\"token punctuation\">,</span> <span class=\"token string\">'top-left'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype test_move2_expected = {\n  board: [\n    ['⭕', '❌', '  '], \n    ['  ', '  ', '  '], \n    ['  ', '  ', '  ']];\n  state: '❌';\n}\n*/</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_move3_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_move2_actual<span class=\"token punctuation\">,</span> <span class=\"token string\">'middle-center'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype test_move3_expected = {\n  board: [\n    [ '⭕', '❌', '  ' ],\n    [ '  ', '❌', '  ' ],\n    [ '  ', '  ', '  ' ]\n  ];\n  state: '⭕';\n};\n*/</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_move4_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_move3_actual<span class=\"token punctuation\">,</span> <span class=\"token string\">'bottom-left'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype test_move4_expected = {\n  board: [\n    [ '⭕', '❌', '  ' ],\n    [ '  ', '❌', '  ' ],\n    [ '⭕', '  ', '  ' ]\n  ];\n  state: '❌';\n};\n*/</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_x_win_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_move4_actual<span class=\"token punctuation\">,</span> <span class=\"token string\">'bottom-center'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype test_x_win_expected = {\n  board: [\n    [ '⭕', '❌', '  ' ],\n    [ '  ', '❌', '  ' ],\n    [ '⭕', '❌', '  ' ]\n  ];\n  state: '❌ Won';\n};\n*/</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">type_move5_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_move4_actual<span class=\"token punctuation\">,</span> <span class=\"token string\">'bottom-right'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype type_move5_expected = {\n  board: [\n    [ '⭕', '❌', '  ' ],\n    [ '  ', '❌', '  ' ],\n    [ '⭕', '  ', '❌' ]\n  ];\n  state: '⭕';\n};\n*/</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_invalid_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_move1_actual<span class=\"token punctuation\">,</span> <span class=\"token string\">'top-center'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype test_invalid_expected = {\n  board: [\n    [ '  ', '❌', '  ' ],\n    [ '  ', '  ', '  ' ],\n    [ '  ', '  ', '  ' ]\n  ];\n  state: '⭕';\n};\n*/</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_before_draw</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  board<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">'⭕'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'❌'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'⭕'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">'⭕'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'❌'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'❌'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">'❌'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'⭕'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  state<span class=\"token operator\">:</span> <span class=\"token string\">'⭕'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_draw_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_before_draw<span class=\"token punctuation\">,</span> <span class=\"token string\">'bottom-right'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype test_draw_expected = {\n  board: [\n    ['⭕', '❌', '⭕'], \n    ['⭕', '❌', '❌'], \n    ['❌', '⭕', '⭕']];\n  state: 'Draw';\n}\n*/</span></code></pre></div>\n<p>The first thing I needed to complete the challege was a type to translate the next position, received as a string\ncombination of <code class=\"language-text\">TicTacToeXPositions</code> and <code class=\"language-text\">TicTacToeYPositions</code>, in a position on the 3x3 board.\nRemember I can use only types, so in this case I needed to implement a string equal check to extract the\ncorresponding position on the board for a specific X and Y position (described as words).<br>\nWell, as I showed already in the <a href=\"/2023/12/30/advent-of-typescript-2023-rock-paper-scissors/\">previous article</a>, I\nleveraged also in this case the power of conditional type.\nIn this specific case I used also the <code class=\"language-text\">infer</code> keyword, that allowed me to access the parts of the move string and\ntranslate them using two support maps, <code class=\"language-text\">XFrom</code> and <code class=\"language-text\">YFrom</code>.<br>\nAs you can see from the code below, the TypeScript type system is so powerful that it is basically able to split a\nstring that matches a specific pattern and gave me access to these parts.\nIn case the move is invalid (e.g., a <code class=\"language-text\">top-center</code> move), I return undefined: this let me check if the move is valid\nbefore doing everything else.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">XFrom<span class=\"token operator\">&lt;</span>TicTacToeXPosition <span class=\"token keyword\">extends</span> TicTacToeXPositions<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">'left'</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">'center'</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">'right'</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">[</span>TicTacToeXPosition<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">YFrom<span class=\"token operator\">&lt;</span>TicTacToeXPosition <span class=\"token keyword\">extends</span> TicTacToeYPositions<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">'top'</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">'middle'</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">'bottom'</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">[</span>TicTacToeXPosition<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">PositionOnBoardFrom<span class=\"token operator\">&lt;</span>Move <span class=\"token keyword\">extends</span> TicTacToePositions<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> \n    Move <span class=\"token keyword\">extends</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">infer</span> TicTacToeYPosition <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeYPositions</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">infer</span> TicTacToeXPosition <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeXPositions</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span> \n        <span class=\"token operator\">?</span> <span class=\"token punctuation\">[</span>YFrom<span class=\"token operator\">&lt;</span>TicTacToeYPosition<span class=\"token operator\">></span><span class=\"token punctuation\">,</span> XFrom<span class=\"token operator\">&lt;</span>TicTacToeXPosition<span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\n        <span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>As I mentioned just a few lines above, I needed to check if the new move is valid. For this goal I created a\n<code class=\"language-text\">IsValidMove</code> type: it will return <code class=\"language-text\">true</code> if the next position exists on the board, and it is not occupied by\nanother chip.\nIn all the other cases, it will return false.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">IsValidMove<span class=\"token operator\">&lt;</span>CurrentTicTacToeGame <span class=\"token keyword\">extends</span> TicTacToeGame<span class=\"token punctuation\">,</span> NextMovePosition <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  NextMovePosition <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">]</span>\n    <span class=\"token operator\">?</span> CurrentTicTacToeGame<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>NextMovePosition<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>NextMovePosition<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeChip</span>\n      <span class=\"token operator\">?</span> <span class=\"token boolean\">false</span>\n      <span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span></code></pre></div>\n<p>At this point, I was ready to define the types needed to update the board (in case the move is valid).\nTo do this, I created a <code class=\"language-text\">UpdateBoard</code> type.\nIt uses <a href=\"https://www.typescriptlang.org/docs/handbook/2/mapped-types.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">mapped types</a> to loop through the board\nand add the chip only to the cell that should be updated.\nTo do this, I created a support <code class=\"language-text\">UpdateColumn</code>.\nIn this way:</p>\n<ul>\n<li>in <code class=\"language-text\">UpdateBoard</code> I loop through the rows until I found the one that correspond to the row contained in\n<code class=\"language-text\">NextMovePosition[0]</code></li>\n<li>in <code class=\"language-text\">UpdateColumn</code> I update the cell corresponding to the column contained in <code class=\"language-text\">NextMovePosition[1]</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">UpdateColumn<span class=\"token operator\">&lt;</span>Row <span class=\"token keyword\">extends</span> TicTacToeCell<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> NextChip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token punctuation\">,</span> ColumnPosition <span class=\"token keyword\">extends</span> <span class=\"token builtin\">number</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">[</span>Index <span class=\"token keyword\">in</span> <span class=\"token keyword\">keyof</span> Row<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span>\n  Index <span class=\"token keyword\">extends</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ColumnPosition<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token operator\">?</span> Row<span class=\"token punctuation\">[</span>Index<span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeEmptyCell</span>\n      <span class=\"token operator\">?</span> NextChip\n      <span class=\"token operator\">:</span> Row<span class=\"token punctuation\">[</span>Index<span class=\"token punctuation\">]</span>\n    <span class=\"token operator\">:</span> Row<span class=\"token punctuation\">[</span>Index<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">UpdateBoard<span class=\"token operator\">&lt;</span>CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token punctuation\">,</span> NextMovePosition <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> NextChip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  NextMovePosition <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">]</span>\n    <span class=\"token operator\">?</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">[</span>Index <span class=\"token keyword\">in</span> <span class=\"token keyword\">keyof</span> CurrentBoard<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span>\n      Index <span class=\"token keyword\">extends</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>NextMovePosition<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token operator\">?</span> UpdateColumn<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">[</span>Index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> NextChip<span class=\"token punctuation\">,</span> NextMovePosition<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">:</span> CurrentBoard<span class=\"token punctuation\">[</span>Index<span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n    <span class=\"token operator\">:</span> CurrentBoard<span class=\"token punctuation\">;</span></code></pre></div>\n<p>The \"last piece of the puzzle\" needed to have a fully functioning tic tac toe implementation is a type that update\nthe state of the game.\nIt should be able to:</p>\n<ul>\n<li>determine if the game is in a final state, given the updated board. That means check if one of the players won.</li>\n<li>if not, determine if we are in a draw state or not and if needed, update the chip to the next one.</li>\n</ul>\n<p>For the first part I created a <code class=\"language-text\">IsSomeoneWinning</code> type.\nIts responsibility is to check for each of the chips if it won the game.\nIt does this by scanning rows, columns and diagonals to check if there is a sequence of three cells with the same\nchip (the one we are checking for winning or not).\nIn all the cases for which there is no win, this type returns <code class=\"language-text\">never</code>.\nSo to check the result of this type, I just needed to check if it <code class=\"language-text\">extends never</code>, meaning that no player won.\nIn all the other cases, it will return a string described which chip won the game.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">RowWinningFor<span class=\"token operator\">&lt;</span>Chip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token punctuation\">,</span> Row <span class=\"token keyword\">extends</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>  Row <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Chip<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> Won</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">ColumnWinningFor<span class=\"token operator\">&lt;</span>Chip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token punctuation\">,</span> ColumnIndex <span class=\"token keyword\">extends</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">[</span>Index <span class=\"token keyword\">in</span> <span class=\"token keyword\">keyof</span> CurrentBoard<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> CurrentBoard<span class=\"token punctuation\">[</span>Index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>ColumnIndex<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Chip<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> Won</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">LeftDiagonalWinning<span class=\"token operator\">&lt;</span>Chip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token punctuation\">,</span> CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span>\n    <span class=\"token operator\">?</span>  CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span>\n      <span class=\"token operator\">?</span>  CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span>\n        <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Chip<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> Won</span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n      <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n    <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">RightDiagonalWinning<span class=\"token operator\">&lt;</span>Chip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token punctuation\">,</span> CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span>\n    <span class=\"token operator\">?</span>  CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span>\n      <span class=\"token operator\">?</span>  CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span>\n        <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Chip<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> Won</span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n      <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n    <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">IsWinning<span class=\"token operator\">&lt;</span>Chip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token punctuation\">,</span> CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  RowWinningFor<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  RowWinningFor<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  RowWinningFor<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  ColumnWinningFor<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  ColumnWinningFor<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  ColumnWinningFor<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  LeftDiagonalWinning<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  RightDiagonalWinning<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">IsSomeoneWinning<span class=\"token operator\">&lt;</span>CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> IsWinning<span class=\"token operator\">&lt;</span><span class=\"token string\">'❌'</span><span class=\"token punctuation\">,</span>CurrentBoard<span class=\"token operator\">></span> <span class=\"token operator\">|</span> IsWinning<span class=\"token operator\">&lt;</span><span class=\"token string\">'⭕'</span><span class=\"token punctuation\">,</span>CurrentBoard<span class=\"token operator\">></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>If none of the players won, I needed t check if there are still empty cells to continue the game. This is the reason\nwhy I created <code class=\"language-text\">AreThereEmptyCells</code>, that checks if the players still have any move available.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">AreThereEmptyCellsOnRow<span class=\"token operator\">&lt;</span>Row <span class=\"token keyword\">extends</span> TicTacToeCell<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  Row <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">infer</span> Current<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token keyword\">infer</span> Others <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeCell</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n    <span class=\"token operator\">?</span> Current <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeEmptyCell</span>\n      <span class=\"token operator\">?</span> <span class=\"token boolean\">true</span>\n      <span class=\"token operator\">:</span> AreThereEmptyCellsOnRow<span class=\"token operator\">&lt;</span>Others<span class=\"token operator\">></span>\n    <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">AreThereEmptyCells<span class=\"token operator\">&lt;</span>CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  AreThereEmptyCellsOnRow<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span>\n  AreThereEmptyCellsOnRow<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span>\n  AreThereEmptyCellsOnRow<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>So now I was able to create the <code class=\"language-text\">UpdateState</code> type as a composition of the previous types. What it does is:</p>\n<ul>\n<li>use <code class=\"language-text\">IsSomeoneWinning</code> to check if someone won. If it is so, its result is returned</li>\n<li>if none of the player won, it uses <code class=\"language-text\">AreThereEmptyCells</code> to check if there are still available moves:</li>\n</ul>\n<p>** if there are, the next chip is returned from <code class=\"language-text\">NextChipFrom</code>\n** if no moves are available, the game is in draw state and <code class=\"language-text\">Draw</code> is returned.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">NextChipFrom<span class=\"token operator\">&lt;</span>CurrentState <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  CurrentState <span class=\"token keyword\">extends</span> <span class=\"token string\">'❌'</span>\n    <span class=\"token operator\">?</span> <span class=\"token string\">'⭕'</span>\n    <span class=\"token operator\">:</span> <span class=\"token string\">'❌'</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">UpdateState<span class=\"token operator\">&lt;</span>CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token punctuation\">,</span> NextMovePosition <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> CurrentChip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  IsSomeoneWinning<span class=\"token operator\">&lt;</span>UpdateBoard<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">,</span> NextMovePosition<span class=\"token punctuation\">,</span> CurrentChip<span class=\"token operator\">>></span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\"><span class=\"token builtin\">never</span></span>\n    <span class=\"token operator\">?</span> AreThereEmptyCells<span class=\"token operator\">&lt;</span>UpdateBoard<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">,</span> NextMovePosition<span class=\"token punctuation\">,</span> CurrentChip<span class=\"token operator\">>></span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\"><span class=\"token boolean\">true</span></span>\n      <span class=\"token operator\">?</span> NextChipFrom<span class=\"token operator\">&lt;</span>CurrentChip<span class=\"token operator\">></span>\n      <span class=\"token operator\">:</span> <span class=\"token string\">'Draw'</span>\n    <span class=\"token operator\">:</span> IsSomeoneWinning<span class=\"token operator\">&lt;</span>UpdateBoard<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">,</span> NextMovePosition<span class=\"token punctuation\">,</span> CurrentChip<span class=\"token operator\">>></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>At this point the final <code class=\"language-text\">TicTacToe</code> game type can be created (again by composition of the previous types). It\nbasically creates a new game state, with an updated <code class=\"language-text\">board</code> and <code class=\"language-text\">state</code>, using the types above.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToe<span class=\"token operator\">&lt;</span>CurrentTicTacToeGame <span class=\"token keyword\">extends</span> TicTacToeGame<span class=\"token punctuation\">,</span> NextMove <span class=\"token keyword\">extends</span> TicTacToePositions<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  IsValidMove<span class=\"token operator\">&lt;</span>CurrentTicTacToeGame<span class=\"token punctuation\">,</span> PositionOnBoardFrom<span class=\"token operator\">&lt;</span>NextMove<span class=\"token operator\">>></span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\"><span class=\"token boolean\">false</span></span>\n    <span class=\"token operator\">?</span> CurrentTicTacToeGame\n    <span class=\"token operator\">:</span> CurrentTicTacToeGame<span class=\"token punctuation\">[</span><span class=\"token string\">'state'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeChip</span>\n      <span class=\"token operator\">?</span> <span class=\"token punctuation\">{</span>\n        board<span class=\"token operator\">:</span> UpdateBoard<span class=\"token operator\">&lt;</span>CurrentTicTacToeGame<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> PositionOnBoardFrom<span class=\"token operator\">&lt;</span>NextMove<span class=\"token operator\">></span><span class=\"token punctuation\">,</span> CurrentTicTacToeGame<span class=\"token punctuation\">[</span><span class=\"token string\">'state'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n        state<span class=\"token operator\">:</span> UpdateState<span class=\"token operator\">&lt;</span>CurrentTicTacToeGame<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> PositionOnBoardFrom<span class=\"token operator\">&lt;</span>NextMove<span class=\"token operator\">></span><span class=\"token punctuation\">,</span> CurrentTicTacToeGame<span class=\"token punctuation\">[</span><span class=\"token string\">'state'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">:</span> CurrentTicTacToeGame<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Below, you can find the full solution and the test cases we saw before to verify its correctness down below.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// domain </span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeChip</span> <span class=\"token operator\">=</span> <span class=\"token string\">'❌'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'⭕'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeEndState</span> <span class=\"token operator\">=</span> <span class=\"token string\">'❌ Won'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'⭕ Won'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'Draw'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeState</span> <span class=\"token operator\">=</span> TicTacToeChip <span class=\"token operator\">|</span> TicTacToeEndState<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeEmptyCell</span> <span class=\"token operator\">=</span> <span class=\"token string\">'  '</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeCell</span> <span class=\"token operator\">=</span> TicTacToeChip <span class=\"token operator\">|</span> TicTacToeEmptyCell<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeYPositions</span> <span class=\"token operator\">=</span> <span class=\"token string\">'top'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'middle'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'bottom'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeXPositions</span> <span class=\"token operator\">=</span> <span class=\"token string\">'left'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'center'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'right'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToePositions</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>TicTacToeYPositions<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>TicTacToeXPositions<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTactToeBoard</span> <span class=\"token operator\">=</span> TicTacToeCell<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToeGame</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  board<span class=\"token operator\">:</span> TicTactToeBoard<span class=\"token punctuation\">;</span>\n  state<span class=\"token operator\">:</span> TicTacToeState<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">EmptyBoard</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">'  '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">'  '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">'  '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">NewGame</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  board<span class=\"token operator\">:</span> EmptyBoard<span class=\"token punctuation\">;</span>\n  state<span class=\"token operator\">:</span> <span class=\"token string\">'❌'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Board</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">XFrom<span class=\"token operator\">&lt;</span>TicTacToeXPosition <span class=\"token keyword\">extends</span> TicTacToeXPositions<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">'left'</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">'center'</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">'right'</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">[</span>TicTacToeXPosition<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">YFrom<span class=\"token operator\">&lt;</span>TicTacToeXPosition <span class=\"token keyword\">extends</span> TicTacToeYPositions<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">'top'</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">'middle'</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">'bottom'</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">[</span>TicTacToeXPosition<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">PositionOnBoardFrom<span class=\"token operator\">&lt;</span>Move <span class=\"token keyword\">extends</span> TicTacToePositions<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  Move <span class=\"token keyword\">extends</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">infer</span> TicTacToeYPosition <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeYPositions</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">infer</span> TicTacToeXPosition <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeXPositions</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token operator\">?</span> <span class=\"token punctuation\">[</span>YFrom<span class=\"token operator\">&lt;</span>TicTacToeYPosition<span class=\"token operator\">></span><span class=\"token punctuation\">,</span> XFrom<span class=\"token operator\">&lt;</span>TicTacToeXPosition<span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\n    <span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">UpdateColumn<span class=\"token operator\">&lt;</span>Row <span class=\"token keyword\">extends</span> TicTacToeCell<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> NextChip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token punctuation\">,</span> ColumnPosition <span class=\"token keyword\">extends</span> <span class=\"token builtin\">number</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">[</span>Index <span class=\"token keyword\">in</span> <span class=\"token keyword\">keyof</span> Row<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span>\n  Index <span class=\"token keyword\">extends</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ColumnPosition<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token operator\">?</span> Row<span class=\"token punctuation\">[</span>Index<span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeEmptyCell</span>\n      <span class=\"token operator\">?</span> NextChip\n      <span class=\"token operator\">:</span> Row<span class=\"token punctuation\">[</span>Index<span class=\"token punctuation\">]</span>\n    <span class=\"token operator\">:</span> Row<span class=\"token punctuation\">[</span>Index<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">UpdateBoard<span class=\"token operator\">&lt;</span>CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token punctuation\">,</span> NextMovePosition <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> NextChip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  NextMovePosition <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">]</span>\n    <span class=\"token operator\">?</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">[</span>Index <span class=\"token keyword\">in</span> <span class=\"token keyword\">keyof</span> CurrentBoard<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span>\n      Index <span class=\"token keyword\">extends</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>NextMovePosition<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token operator\">?</span> UpdateColumn<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">[</span>Index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> NextChip<span class=\"token punctuation\">,</span> NextMovePosition<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">:</span> CurrentBoard<span class=\"token punctuation\">[</span>Index<span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n    <span class=\"token operator\">:</span> CurrentBoard<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// State </span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">NextChipFrom<span class=\"token operator\">&lt;</span>CurrentState <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  CurrentState <span class=\"token keyword\">extends</span> <span class=\"token string\">'❌'</span>\n    <span class=\"token operator\">?</span> <span class=\"token string\">'⭕'</span>\n    <span class=\"token operator\">:</span> <span class=\"token string\">'❌'</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">RowWinningFor<span class=\"token operator\">&lt;</span>Chip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token punctuation\">,</span> Row <span class=\"token keyword\">extends</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>  Row <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Chip<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> Won</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">ColumnWinningFor<span class=\"token operator\">&lt;</span>Chip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token punctuation\">,</span> ColumnIndex <span class=\"token keyword\">extends</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">[</span>Index <span class=\"token keyword\">in</span> <span class=\"token keyword\">keyof</span> CurrentBoard<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> CurrentBoard<span class=\"token punctuation\">[</span>Index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>ColumnIndex<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Chip<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> Won</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">LeftDiagonalWinning<span class=\"token operator\">&lt;</span>Chip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token punctuation\">,</span> CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span>\n    <span class=\"token operator\">?</span>  CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span>\n      <span class=\"token operator\">?</span>  CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span>\n        <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Chip<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> Won</span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n      <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n    <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">RightDiagonalWinning<span class=\"token operator\">&lt;</span>Chip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token punctuation\">,</span> CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span>\n    <span class=\"token operator\">?</span>  CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span>\n      <span class=\"token operator\">?</span>  CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Chip</span>\n        <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Chip<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> Won</span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n      <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n    <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">IsWinning<span class=\"token operator\">&lt;</span>Chip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token punctuation\">,</span> CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  RowWinningFor<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  RowWinningFor<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  RowWinningFor<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  ColumnWinningFor<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  ColumnWinningFor<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  ColumnWinningFor<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  LeftDiagonalWinning<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token operator\">></span> <span class=\"token operator\">|</span>\n  RightDiagonalWinning<span class=\"token operator\">&lt;</span>Chip<span class=\"token punctuation\">,</span> CurrentBoard<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">IsSomeoneWinning<span class=\"token operator\">&lt;</span>CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> IsWinning<span class=\"token operator\">&lt;</span><span class=\"token string\">'❌'</span><span class=\"token punctuation\">,</span>CurrentBoard<span class=\"token operator\">></span> <span class=\"token operator\">|</span> IsWinning<span class=\"token operator\">&lt;</span><span class=\"token string\">'⭕'</span><span class=\"token punctuation\">,</span>CurrentBoard<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">AreThereEmptyCellsOnRow<span class=\"token operator\">&lt;</span>Row <span class=\"token keyword\">extends</span> TicTacToeCell<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  Row <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">infer</span> Current<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token keyword\">infer</span> Others <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeCell</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n    <span class=\"token operator\">?</span> Current <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeEmptyCell</span>\n      <span class=\"token operator\">?</span> <span class=\"token boolean\">true</span>\n      <span class=\"token operator\">:</span> AreThereEmptyCellsOnRow<span class=\"token operator\">&lt;</span>Others<span class=\"token operator\">></span>\n    <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">AreThereEmptyCells<span class=\"token operator\">&lt;</span>CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  AreThereEmptyCellsOnRow<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span>\n  AreThereEmptyCellsOnRow<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span>\n  AreThereEmptyCellsOnRow<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">UpdateState<span class=\"token operator\">&lt;</span>CurrentBoard <span class=\"token keyword\">extends</span> TicTactToeBoard<span class=\"token punctuation\">,</span> NextMovePosition <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> CurrentChip <span class=\"token keyword\">extends</span> TicTacToeChip<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  IsSomeoneWinning<span class=\"token operator\">&lt;</span>UpdateBoard<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">,</span> NextMovePosition<span class=\"token punctuation\">,</span> CurrentChip<span class=\"token operator\">>></span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\"><span class=\"token builtin\">never</span></span>\n    <span class=\"token operator\">?</span> AreThereEmptyCells<span class=\"token operator\">&lt;</span>UpdateBoard<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">,</span> NextMovePosition<span class=\"token punctuation\">,</span> CurrentChip<span class=\"token operator\">>></span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\"><span class=\"token boolean\">true</span></span>\n      <span class=\"token operator\">?</span> NextChipFrom<span class=\"token operator\">&lt;</span>CurrentChip<span class=\"token operator\">></span>\n      <span class=\"token operator\">:</span> <span class=\"token string\">'Draw'</span>\n    <span class=\"token operator\">:</span> IsSomeoneWinning<span class=\"token operator\">&lt;</span>UpdateBoard<span class=\"token operator\">&lt;</span>CurrentBoard<span class=\"token punctuation\">,</span> NextMovePosition<span class=\"token punctuation\">,</span> CurrentChip<span class=\"token operator\">>></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Global checks</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">IsValidMove<span class=\"token operator\">&lt;</span>CurrentTicTacToeGame <span class=\"token keyword\">extends</span> TicTacToeGame<span class=\"token punctuation\">,</span> NextMovePosition <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  NextMovePosition <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">]</span>\n    <span class=\"token operator\">?</span> CurrentTicTacToeGame<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>NextMovePosition<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>NextMovePosition<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeChip</span>\n      <span class=\"token operator\">?</span> <span class=\"token boolean\">false</span>\n      <span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n\n<span class=\"token comment\">// Main</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TicTacToe<span class=\"token operator\">&lt;</span>CurrentTicTacToeGame <span class=\"token keyword\">extends</span> TicTacToeGame<span class=\"token punctuation\">,</span> NextMove <span class=\"token keyword\">extends</span> TicTacToePositions<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span>\n  IsValidMove<span class=\"token operator\">&lt;</span>CurrentTicTacToeGame<span class=\"token punctuation\">,</span> PositionOnBoardFrom<span class=\"token operator\">&lt;</span>NextMove<span class=\"token operator\">>></span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\"><span class=\"token boolean\">false</span></span>\n    <span class=\"token operator\">?</span> CurrentTicTacToeGame\n    <span class=\"token operator\">:</span> CurrentTicTacToeGame<span class=\"token punctuation\">[</span><span class=\"token string\">'state'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TicTacToeChip</span>\n      <span class=\"token operator\">?</span> <span class=\"token punctuation\">{</span>\n        board<span class=\"token operator\">:</span> UpdateBoard<span class=\"token operator\">&lt;</span>CurrentTicTacToeGame<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> PositionOnBoardFrom<span class=\"token operator\">&lt;</span>NextMove<span class=\"token operator\">></span><span class=\"token punctuation\">,</span> CurrentTicTacToeGame<span class=\"token punctuation\">[</span><span class=\"token string\">'state'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n        state<span class=\"token operator\">:</span> UpdateState<span class=\"token operator\">&lt;</span>CurrentTicTacToeGame<span class=\"token punctuation\">[</span><span class=\"token string\">'board'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> PositionOnBoardFrom<span class=\"token operator\">&lt;</span>NextMove<span class=\"token operator\">></span><span class=\"token punctuation\">,</span> CurrentTicTacToeGame<span class=\"token punctuation\">[</span><span class=\"token string\">'state'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">:</span> CurrentTicTacToeGame<span class=\"token punctuation\">;</span>\n\n\n<span class=\"token comment\">// ---- TEST CASES -----</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_move1_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>NewGame<span class=\"token punctuation\">,</span> <span class=\"token string\">'top-center'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_move2_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_move1_actual<span class=\"token punctuation\">,</span> <span class=\"token string\">'top-left'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype test_move2_expected = {\n  board: [\n    ['⭕', '❌', '  '], \n    ['  ', '  ', '  '], \n    ['  ', '  ', '  ']];\n  state: '❌';\n}\n*/</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_move3_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_move2_actual<span class=\"token punctuation\">,</span> <span class=\"token string\">'middle-center'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype test_move3_expected = {\n  board: [\n    [ '⭕', '❌', '  ' ],\n    [ '  ', '❌', '  ' ],\n    [ '  ', '  ', '  ' ]\n  ];\n  state: '⭕';\n};\n*/</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_move4_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_move3_actual<span class=\"token punctuation\">,</span> <span class=\"token string\">'bottom-left'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype test_move4_expected = {\n  board: [\n    [ '⭕', '❌', '  ' ],\n    [ '  ', '❌', '  ' ],\n    [ '⭕', '  ', '  ' ]\n  ];\n  state: '❌';\n};\n*/</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_x_win_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_move4_actual<span class=\"token punctuation\">,</span> <span class=\"token string\">'bottom-center'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype test_x_win_expected = {\n  board: [\n    [ '⭕', '❌', '  ' ],\n    [ '  ', '❌', '  ' ],\n    [ '⭕', '❌', '  ' ]\n  ];\n  state: '❌ Won';\n};\n*/</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">type_move5_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_move4_actual<span class=\"token punctuation\">,</span> <span class=\"token string\">'bottom-right'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype type_move5_expected = {\n  board: [\n    [ '⭕', '❌', '  ' ],\n    [ '  ', '❌', '  ' ],\n    [ '⭕', '  ', '❌' ]\n  ];\n  state: '⭕';\n};\n*/</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_invalid_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_move1_actual<span class=\"token punctuation\">,</span> <span class=\"token string\">'top-center'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype test_invalid_expected = {\n  board: [\n    [ '  ', '❌', '  ' ],\n    [ '  ', '  ', '  ' ],\n    [ '  ', '  ', '  ' ]\n  ];\n  state: '⭕';\n};\n*/</span>\n\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_before_draw</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  board<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">'⭕'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'❌'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'⭕'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">'⭕'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'❌'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'❌'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">'❌'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'⭕'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'  '</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  state<span class=\"token operator\">:</span> <span class=\"token string\">'⭕'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">test_draw_actual</span> <span class=\"token operator\">=</span> TicTacToe<span class=\"token operator\">&lt;</span>test_before_draw<span class=\"token punctuation\">,</span> <span class=\"token string\">'bottom-right'</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/*\ntype test_draw_expected = {\n  board: [\n    ['⭕', '❌', '⭕'], \n    ['⭕', '❌', '❌'], \n    ['❌', '⭕', '⭕']];\n  state: 'Draw';\n}\n*/</span></code></pre></div>\n<h4>Conclusion</h4>\n<p>As I mentioned at the beginning, this is the first of the four challenges I liked the most from \"Advent Of TypeScript\n2023\" by <a href=\"https://typehero.dev\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">TypeHero</a>. Check out the other challenges I liked <a href=\"/2023/12/29/advent-of-typescript-2023-favourite-challenges/\" title=\"advent of typescript 2023 challenges\">here</a>.</p>","frontmatter":{"title":"Advent of TypeScript 2023: Tic tac toe (Day 21)","comments":true,"authors":["fabrizio_duroni"],"tags":["typescript","advent of typescript 2023"],"date":"04 Jan 2024","description":"Tic tac toe, another classical kata games you can find at a coding dojo. A game that is simple to implement with  functions, variables etc. becomes a real challenge when you try to implement it using only types.","math":false,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#080808","images":{"fallback":{"src":"/static/18362a48e96779b2552e31966e956c30/f0c46/advent-of-typescript-tic-tac-toe.jpg","srcSet":"/static/18362a48e96779b2552e31966e956c30/82ea3/advent-of-typescript-tic-tac-toe.jpg 750w,\n/static/18362a48e96779b2552e31966e956c30/15ef9/advent-of-typescript-tic-tac-toe.jpg 1080w,\n/static/18362a48e96779b2552e31966e956c30/9d4f0/advent-of-typescript-tic-tac-toe.jpg 1366w,\n/static/18362a48e96779b2552e31966e956c30/f0c46/advent-of-typescript-tic-tac-toe.jpg 1920w","sizes":"100vw"},"sources":[{"srcSet":"/static/18362a48e96779b2552e31966e956c30/d472f/advent-of-typescript-tic-tac-toe.webp 750w,\n/static/18362a48e96779b2552e31966e956c30/871c3/advent-of-typescript-tic-tac-toe.webp 1080w,\n/static/18362a48e96779b2552e31966e956c30/7b348/advent-of-typescript-tic-tac-toe.webp 1366w,\n/static/18362a48e96779b2552e31966e956c30/5b456/advent-of-typescript-tic-tac-toe.webp 1920w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6463541666666667}}}},"fields":{"slug":"/2024/01/04/advent-of-typescript-2023-tic-tac-toe/","readingTime":{"text":"14 min read"}}},"site":{"siteMetadata":{"author":"Fabrizio Duroni"}}},"pageContext":{"slug":"/2024/01/04/advent-of-typescript-2023-tic-tac-toe/"}},"staticQueryHashes":["2055070849","3076394108","379746230","4028829600"],"slicesMap":{}}